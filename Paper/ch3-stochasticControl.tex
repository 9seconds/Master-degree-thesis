\chapter{Методы стохастического управления}
% ==============================================================================================
\newcommand{\mSig}{     \sff{\Sigma}                     } % матрица ковариаций

\newcommand{\setTime}{  [0, T]                           } % временной промежуток, который достало вводить
\newcommand{\setX}{     \calf{X}                         } % множество X
\newcommand{\setT}{     \calf{T}                         } % множество T
\newcommand{\setF}{     \calf{F}                         } % множество F
\newcommand{\setM}{     \calf{M}_2\bigl( \setTime \bigr) } % множество M2
\newcommand{\setK}{     \calf{K}_2\bigl( \setTime \bigr) } % множество K2

\newcommand{\argEmpty}{ \{\emptyarg\}                    } % пустой аргумент

\newcommand{\funcF}{    \calf{F}                         } % функция качества
\newcommand{\funcH}{    \calf{H}                         } % функция качества H
% ==============================================================================================


% **********************************************************************************************
\section{Некоторые сведения из теории случайных процессов}
% **********************************************************************************************



Перед рассмотрением методов стохастического управления, дадим некоторые сведения из теории вероятностей, в частности из теории случайных процессов.

\begin{df}\lbl{df:1}
    Семейство случайных величин, параметризованное параметров $t$, интерпретируемым как время, будем называть случайным процессом и обозначать как
    
    \beqn
    	\xi_t \eqdef \xi(t, \omega) \in \setX \subset \Rv{1}
    \eeqn

    где $t \in \setT \subset \Rv{1}$~--- временной параметр; $\setT$~--- множество определения, а $\setX$~--- множество значений случайного процесса $\xi_t$.
\end{df}

Область определения $\setT$ случайного процесса может быть конечным, полубесконечным или бесконечным интервалом числовой прямой. В этих случаях $\xi(t, \omega)$ называется \emph{случайным процессом с непрерывным временем}. Если $\setT$ имеет конечное или счетное множество элементов $t_k \in \setT: t_k < t_{k+1}$ ($k = 0, 1, 2, \ldots$), то $\xi_t$ называется \emph{случайным процессом с дискретным временем} или \emph{случайной последовательностью}.

Случайный процесс считается полностью заданным, если заданы его конечномерные распределения~--- набор функций распределения.

Случайный процесс называется \emph{гауссовским}, если все его совместные плотности распределения являются гауссовскими:

\beqn
	\prob_\xi(x1, x2, \ldots, x_k, t_1, t_2, \ldots, t_k) = \frac{1}{\sqrt{(2\pi)^n \det(\mSig)}}\exp\biggl( -\frac{(x-m)^T\mSig^{-1}(x-m)}{2} \biggr) \mbox{,}
\eeqn

где $x = (x_1, x_2, \ldots, x_k)^T$; $m = (m_1, m_2, \ldots, m_k)^T$; $m_i = \E x_i$; $\mSig = \mSig^T > 0$~--- матрица ковариаций.

Случайный процесс $\xi_t$, заданный на $\setT$, называется \emph{стационарным в узком смысле}, если для любых $n \geqslant 1$ и любых моментов $t_1, t_2, \ldots, t_n, t$, таких, что $t_i + t \in \setT$ ($i = 1, 2, \ldots, n$), совместные функции распределения совокупности случайных величин $\xi_{t_1+t}, \xi_{t_2+t}, \ldots, \xi_{t_n+1}$ не зависят от $t$.

\begin{df}\lbl{df:2}
	Случайный процесс $\xi_t$, определенный при всех $t \in \setTime$, называется непрерывным в момент времени $t^{*} \in \setTime$ в вероятностном смысле, если для любой последовательности $\{t_k\}_{k=1}^\infty$, принадлежащей $[0, T]$ и сходящейся к $t^{*}$ при $k \to \infty$, справедливо предельное соотношение
	
	\beqn
		\xi_{t_k} \to \xi_{t^{*}} \mbox{ при } t_k \to t^{*}  \mbox{,}
	\eeqn
	
	понимаемое в соответствующем вероятностном смысле.
\end{df}

\begin{df}\lbl{df:3}
	Случайный процесс $\xi_t$ называется непрерывным на промежутке $[t_1, t_2]$ в данном вероятностном смысле, если он непрерывен в этом смысле при $\forall t \in [t_1, t_2]$. Непрерывность в среднем степени 2 случайного процесса $\xi_t$ будем называть среднеквадратической непрерывностью.
\end{df}

\begin{df}\lbl{df:4}
	Случайный процесс $\xi_t$, определеный для всех $t \in \setTime$, называется дифференцируемым в момент $t \in \setTime$ в одном из вероятностных смыслов, если существует левая часть следующего предельного соотношения:
	
	\beqn
		\lim\limits_{\delta \to 0} \frac{\xi_{t+\delta} - \xi_t}{\delta} = \genericdiff{\xi_t}{t} \mbox{,}
	\eeqn
	
	понимаемого в этом вероятностном смысле. Процесс $\xi_t$ будем называть дифференцируемым на промежутке $[t_1, t_2] \subset \setTime$ в данном вероятностном смысле, если он дифференцируем в этом смысле при всех $t \in [t_1, t_2]$.
\end{df}

\begin{df}\lbl{df:5}
	Случайный процесс $\xi_t$, определеный для всех $t \in \setTime$, называется процессом с независимыми приращениями, если для любых $t_0, t_1, \ldots, t_k \in \setTime$ ($0 \leqslant t_0 < t_1 < \ldots < t_k \leqslant T$), случайные величины $\xi_{t_0}, \xi_{t_1}-\xi_{t_0}, \ldots, \xi_{t_k}-\xi_{t_{k-1}}$ стохастически независимы между собой.
\end{df}

Особую роль в дальнейшем изложении будут играть так называемые винеровские случайные процессы, относящиеся к классу гауссовских процессов с независимыми приращениями\footnote{ Подробное изложение теории случайных процессов с независимыми приращениями можно найти в монографии А.\,В.\,Скорохода (TODO) }.

\begin{df}\lbl{df:6}
	Случайный процесс $\xi_t \in \Rv{1}$, определеный для всех $t \in \setTime$, называется винеровским, если он является процессом с независимыми приращениями и удовлетворяет следующим условиям
	
	\benum
		\item
			$\E \xi_t = 0$,
		
		\item
			$\E (\xi_{t_2} - \xi_{t_1})^2 - \sigma_\xi^2 |t_2 - t_1| \mbox{, где } \sigma_\xi^2 > 0$,
		
		\item
			$\xi_{t_1}$ и $\xi_{t_2} - \xi_{t_1}$ ($t_2 > t_1$) имеют нормальное распредление при всех $t_1, t_2 \in \setTime$.
	\eenum
\end{df}

Если $\sigma_\xi^2$ и $\xi_0 = 0$, то винеровский процесс называется \emph{стандартным}. Поскольку приращения $\xi_{t_2} - \xi_{t_1}$ ($t_2 > t_1$) винеровского процесса имеют нормальное распределение, то их функция распределения определяется соотношением

\beqn
	\prob(\xi_{t_2} - \xi_{t_1} < x) = \frac{1}{\sigma_\xi \sqrt{2\pi (t_2 - t_1)}} \int\limits_\infty^x e^{-\frac{u^2}{2\sigma_xi^2(t_2-t_1)}}\,du \mbox{.}
\eeqn

Известно, что винеровский случайный процесс является непрерывным с вероятностью 1 случайным процессом.

\br

Определим теперь понятия интегралов и процессов Ито.

Пусть задано вероятностное пространство $(\Omega, \setF, \prob)$ и винеровский случайный процесс $f_t \in \Rv{1}$. Рассмотрим совокупность $\sigma$-алгебр $\{ \setF_t, t \in \setTime \}$, определенную на вероятностном пространстве $(\Omega, \setF, \prob)$ и связанную с винеровским процессом $f_t$ так, что

\benum
	\item
		$\setF_s \subset \setF_t \subset \setF$ при $s<t$;
	
	\item
		$f_t$ измерим относительно $\setF_t$ при каждом $t \in \setTime$;
		
	\item
		Процесс $f_{t+\Delta} - f_\Delta$ при всех $\Delta \geqslant 0$ и $t > 0$ не зависит от событий $\sigma$-алгебры $\setF_\Delta$.
\eenum

В дальнейшем рассматриваются только такие винеровские процессы $f_t$, которые удовлетворяют условиям 2 и 3.

Введем в рассмотрение класс $\setM$ функций $\xi: \setTime \times \Omega \to \Rv{1}$, которые удовлетворяют следующим условиям:

\benum
	\item
		Функции $\xi(t, \omega)$ измеримы по совокупности переменных $(t, \omega)$;
	
	\item
		Функция $\xi(t, \omega) \in \setF_t$ измерима при всех $t \in \setTime$, и ее значения $\xi(\tau, \omega)$ не зависят от приращений $f_{t+\Delta} - f_\Delta$ винеровского процесса при $\Delta \geqslant \tau$, $t > 0$;
	
	\item
		$\int_0^T \E \Bigl\{ \bigl( \xi(t, \omega) \bigr)^2 \Bigr\}\,dt < \infty$;
	
	\item
		$\E \Bigl\{ \bigl( \xi(t, \omega) \bigr)^2 \Bigr\} < \infty$ для всех $t \in \setTime$.
\eenum

Введем на классе $\setM$ норму вида

\beqn
	\| \xi \|_{2,T} = \sqrt{ \int_0^T \E \Bigl\{ \bigl( \xi(t, \omega) \bigr)^2 \Bigr\}\,dt } \mbox{.}
\eeqn

Считаем две функции $\xi$ и $\eta$ из класса $\setM$ эквивалентными, если $\| \xi - \eta \|_{2,T} = 0$.

Для произвольного разбиения $\{ \tau_j \}_{j=0}^N$ промежутка $\setTime$, такого что $0 = \tau_0 < \tau_1 < \ldots < \tau_N = T$, и произвольной последовательности среднеквадратически интегрируемых, $\setF_{\tau_j}$-измеримых и независящим от приращений $f_{s+t} - f_t$ при $t \geqslant \tau_j$, $s > 0$ случайных величин $\xi_j(\omega)$ ($j = 0, 1, \ldots, N-1$), определим \emph{ступенчатую функцию} $\xi \in \setM$ следующим образом: $\xi(t, \omega) = \xi_j(\omega)$ с вероятностью 1 при $\tau_j \leqslant t < \tau_{j+1}$ ($j = 0, 1, \ldots, N-1$).

При этом интеграл в требовании 3 понимается как

\beqn
	\int\limits_0^T \E \Bigl\{ \bigl( \xi(t, \omega) \bigr)^2 \Bigr\}\,dt = \sum\limits_{j=0}^{N-1} \E \bigl\{ (\xi_j)^2 \bigr\}(\tau_{j+1} - \tau{j}) \mbox{.}
\eeqn

Обозначим через $\setK$ множество всех ступенчатых функций в $\setM$. Для произвольной ступенчатой функции $\xi$ из класса $\setK$ определим \emph{стохастический интеграл Ито} следующим образом:

\beqn
	\int\limits_0^T \xi_\tau\,df_\tau \eqdef \sum\limits_{j=0}^{N-1} \xi_j(\omega)\bigl( f(\tau_{j+1}, \omega) - f(\tau_j, \omega) \bigr) \mbox{.}
\eeqn

\begin{df}\lbl{df:7}
	Стохастическим интегралом Ито от функции $\xi \in \setM$ назовем среднеквадратический предел последовательности ступенчатых функций:
	
	\beqn
		\int\limits_0^T \xi_\tau\,df_\tau = \lim\limits_{N \to \infty} \sum\limits_{j=0}^{N-1} \xi^{(N)}\bigl( f(\tau^{(N)}_{j+1}, \omega) - f(\tau^{(N)}_j, \omega) \bigr) \mbox{,} 
	\eeqn
	
	где $\xi^{(N)}(t, \omega)$~--- произвольная ступенчатая функция из $\setK$, сходящаяся по норме $\| \emptyarg \|_{2,T}$ к функции $\xi(t, \omega)$.
\end{df}

Известно, что для $\xi \in \setM$ такой интеграл существует (TODO).

\br

Винеровские случайные процессы порождают широкий класс случайных процессов, называемых процессами Ито.

Пусть задано фиксированное вероятностное пространство $(\Omega, \setF, \prob)$ и $\setF_t$-измеримый при всех $t \in \setTime$ векторный винеровский процесс $\m{f}_t \in \Rv{m}$ с независимыми компонентами $\m{f}_t^{(i)}$ ($i = 1, 2, \ldots, m$).

Рассмотрим случайные процессы $a_t \in \Rv{1}$ и $\m{b}_t^{(i)} \in \Rv{1}$ ($i = 1, 2, \ldots, m$) из класса $\setM$. Определим случайный процесс $\eta_t$ при всех $t \in \setTime$ в виде:

\beq{eq:3/1/1}
	\eta_t = \eta_0 + \int\limits_0^t a_\tau\,d\tau + \sum\limits_{i=1}^m \int\limits_0^t \m{b}_\tau^{(i)}\,d\m{f}_\tau^{(i)} \mbox{,}
\eeq

где $\eta_0$~--- случайная величина, стохастически независимая от приращений $\m{f}_\tau-\m{f}_0$ винеровского процесса $\m{f}_t$ при всех $\tau \in \setTime$.

\begin{df}\lbl{df:8}
	Процесс $\eta_t$, определенный на промежутке $\setTime$ в виде~\ref{eq:3/1/1}, называется процессом Ито, если правая часть~\ref{eq:3/1/1} существует при всех $t \in \setTime$. При этом процесс $a_t$ называется коэффициентом сноса, а процессы $\m{b}_t^{(i)}$ ($i = 1, 2, \ldots, m$)~--- коэффициентами диффузии процесса $\eta_t$.
\end{df}

Из свойства аддитивности стохастических интегралов вытекает следующее представление для процесса Ито:

\beq{eq:3/1/2}
	\eta_s = \eta_t + \int\limits_t^s a_\tau\,d\tau + \sum\limits_{i=1}^m \int\limits_0^t \m{b}_\tau^{(i)}\,d\m{f}_\tau^{(i)} \mbox{ с вероятностью 1,}
\eeq

справедливое для всех $s, t \in \setTime$ и $s \geqslant t$.

Рассмотрим многомерный случай. Пусть существуют случайные процессы $\m{a}_t \in \Rv{n}$ и $\m{B}_t \in \Rs{n}{m}$, каждая компонента которых должна принадлежать классу $\setM$. Определим векторный случайный процесс $\m{\eta}_t \in \Rv{n}$ при всех $t \in \setTime$ в виде:

\beq{eq:3/1/3}
	\m{\eta}_t = \m{\eta}_0 + \int\limits_0^t \m{a}_\tau\,d\tau + \int\limits_0^t \m{B}_\tau\,d\m{f}_\tau \mbox{,}
\eeq

где случайная векторная величина $\m{\eta}_0 \in \Rv{n}$ является стохастически независимой от приращений $\m{f}_\tau - \m{f}_0$ винеровского процесса $\m{f}_t$ при всех $\tau \in \setTime$.

\begin{df}\lbl{df:9}
	Процесс $\m{\eta}_t \in \Rv{n}$ вида~\ref{eq:3/1/2}, определенный на промежутке $\setTime$ называется векторным процессом Ито, если правая часть~\ref{eq:3/1/2} существует при всех $t \in \setTime$. При этом процессы $\m{a}_t^{(i)}$ называются коэффициентами снова, а процессы $\m{B}_t^{(ij)}$ называются коэффициентами диффузии процесса $\m{\eta}_t$ ($i = 1, 2, \ldots, n$, $j = 1, 2, \ldots, m$).
\end{df}

Соотношение~\ref{eq:3/1/2} обобщается и на случай векторного процесса Ито:

\beq{eq:3/1/4}
	\eta_s = \eta_t + \int\limits_t^s \m{a}_\tau\,d\tau + \int\limits_0^t \m{B}_\tau^{(i)}\,d\m{f}_\tau} \mbox{ с вероятностью 1,}
\eeq

справедливое для всех $s, t \in \setTime$ и $s \geqslant t$.

\br

Процессы Ито тесно связаны со стохастическими дифференциальными уравнениями Ито. Действительно, пусть задано дифференциальное уравнение

\beq{eq:3/1/5}
	dx_t = a(x_t, t)dt + \sigma(x_t, t)df_t \mbox{; } x_0 = x(0, \omega) \mbox{,}
\eeq

где $x_t \in \Rv{1}$~--- случайный процесс, являющийся решением уравнения~\ref{eq:3/1/5}; $a(x, t)$ и $\sigma(x, t) \in Rv{1}$~--- измеримые при всех $(x, t) \in \Rv{1} \times \setTime$ функции. Тогда это уравнение может быть переписано в интегральном виде

\beq{eq:3/1/6}
	x_t = x_0 + \int\limits_0^t a(x_\tau, \tau)\,d\tau + \int\limits_0^t \sigma(x_\tau, \tau)\,df_\tau \mbox{; } x_0 = x(0, \omega) \mbox{.}
\eeq

Второй интеграл в правой части~\ref{eq:3/1/6} может пониматься в смысле Ито, Стратоновича или как $\theta$-интеграл (TODO). Пусть интеграл $\int_0^t \sigma(x_\tau, \tau)\,df_\tau$ является стохастическим интегралом Ито, тогда уравнение~\ref{eq:3/1/5} и соответствующее ему уравнение~\ref{eq:3/1/6} называются стохастическими дифференциальными уравнениями Ито.



% **********************************************************************************************
\section{Оптимальное стохастическое управление}
% **********************************************************************************************



Пусть уравнение состояния динамической системы представляет собой систему стохастических дифференциальных уравнений Ито

\beq{eq:3/2/1}
	d\m{x}_t = \m{a}(\m{x}_t, \m{u}, t)dt + \m{\Sigma}(\m{x}_t, \m{u}, t)d\m{f}_t \mbox{,}
\eeq

где $\m{x}_t \in \Rv{n}$~--- случайный процесс, являющийся решением уравнения~\ref{eq:3/2/1}; $\m{a} \in \Rv{n}$, $\m{\Sigma} \in \Rv{n}$ представляют собой векторные функции сноса и диффузии соответственно; $\m{f}_t$~--- стандартный винеровский процесс, моделирующий белый шум; $\m{u} \in \Rv{k}$~--- управляющее воздействие, которое выбирается из условия минимизации функционала вида

\beq{eq:3/2/2}
	\funcF(\m{x}, \m{u}, s) = \E \Biggl\{ Q(\m{x}_\tau, \tau) + \int\limits_s^\tau F(\m{x}_t, \m{u}, t)\,dt~\Biggm|~ \m{x}_s = \m{x} \Biggr\} \mbox{,}
\eeq

где $Q$, $F$~--- известные функции, а $\tau$, например, постоянный момент времени.

Известны различные типы управляющих воздействий, которые могут использовать или не использовать информацию о векторе состояния системы в предшествующие моменты времени (некоторые из них были рассмотрены в предыдущем разделе). Рассмотрим управление $\m{u}(\m{x}_t, t)$ марковского типа. Тогда для него минимальная по $u$ величина функционала $\funcF$, которую обозначим через $\funcH(\m{x}, s)$, удовлетворяет уравнению Гамильтона-Якоби-Беллмана вида

\beqarr
	\lbl{eq:3/2/3}
		\min\limits_{\m{u} \in \Rv{k}} \bigl\{ F(\m{x}, \m{u}, s) + L_u \funcH(\m{x}, s) \bigr\} = 0 \mbox{;} \\
	\lbl{eq:3/2/4}
		\funcH(\m{x}, T) = Q(\m{x}, T) \mbox{,}
\eeqarr

где предполагается, что $\tau = T$, а оператор $L_u\argEmpty$ имеет вид

\beq{eq:3/2/5}
	L_u\argEmpty = \partdiff{\argEmpty}{s} + \sum\limits_{i=1}^n\m{a}^{(i)} \mbox{,}
\eeq








% **********************************************************************************************
\section{Стохастическая устойчивость}
% **********************************************************************************************