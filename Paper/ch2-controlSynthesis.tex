% coding: \m{u}tf-8
% --------------------------------------------------------------------------------------------------
% "Синтез оптимального стохастического управления", 2011 год
% --------------------------------------------------------------------------------------------------



\chapter{Синтез оптимального управления}
% ==============================================================================================
\renewcommand{\funcF}{ \calf{F}           } % функция качества
\renewcommand{\optF}{  \optimum{\funcF}   } % оптимальная функция F
\newcommand{\optU}{    {\optimum{\m{u}}}  } % оптимальное управление \m{u}
\newcommand{\optX}{    {\optimum{\m{x}}}  } % оптимальная траектория \m{x}
\newcommand{\funcL}{   \sff{L}            } % функция Лагранжа
\newcommand{\funcT}{   \optimum{\sff{F}}  } % передаточная функция F
\newcommand{\funcV}{   \sff{V}            } % функция Ляпунова
\newcommand{\funcH}{   \optimum{H}        } % функция Гамильтона

\newcommand{\setS}{    \cale{S}           } % множество S
\newcommand{\setV}{    \cale{V}           } % множество V
% ==============================================================================================




% **********************************************************************************************
\section{Принцип Беллмана}
% **********************************************************************************************



Рассмотрим следующую задачу Лагранжа. Для системы $\dot{\m{x}} = f(\m{x}, \m{u}, t)$, начинающей движение из начального состояния $\m{x}(t_1) = \m{x}_1$, найдем управление $\m{u}(t)$, ограниченное некоторым допустимым классом функций $\m{\Omega}(t)$ и определенное на интервале времени $[t_1, t_2]$, которое минимизирует показатель качества

\beq{eq:2/1/1}
    \funcF = \int\limits_{t_1}^{t_2} \funcL(\m{x}, \m{u}, t)\,dt \text{,}
\eeq

где функция $\funcL(\m{x}, \m{u}, t)$ предполагается непрерывной по $t$. Конечное состояние $\m{x}(t_2) = \m{x}_2$ не задано. Все функции, принадлежащие $\m{\Omega}(t)$ ограничены по амплитуде в любой момент времени $t$ $|u_j(t)| \leqslant V_j$. Множество точек $|u_j(t)| \leqslant V_j$ ($j = 1, 2, \ldots, n$) будем обозначать как $\Upsilon$.

Показатель качества $\funcF$ для фиксированного значения $t_2$ зависит от переменных $\m{u}(t)$, $\m{x}_1$ и $t_1$. Однако оптимальное значение функционала $\funcF$ зависит лишь от начального состояния $\m{x}_1$ и момента времени $t_1$. Обозначим оптимальное значение этого функционала как $\optF(\m{x}_1, t_1)$. Если поставлена задача оптимального управления, то для каждой точки $\m{x}_1$ ставится в соответствие некоторое значение критерия оптимальности. Функция $\optF(\m{x}_1, t_1)$ определяет гиперповерхность в $(n+1)$-мерном пространстве. Эта гиперповерхность, конечно, в явном виде не задана, но некоторые ее свойства позволяют вывести ряд необходимых условий, которым должна удовлетворять функция оптимального управления $\optU(t)$.

Обозначим через $\m{x} \bigl( \m{u}(t), t \bigr)$ траекторию, которая получается в результате воздействия управления $\m{u}(t)$ на систему $\dot{\m{x}} = f(\m{x}, \m{u}, t)$ с начальным состоянием $\m{x}_1$ в момент времени $t = t_1$. При этом $\optF$ определяется выражением

\beq{eq:2/1/2}
    \optF(\m{x}_1, t_1) = \underset{\substack{\m{u}(t) \in \m{\Omega}(t) \\ t_1 \leqslant t \leqslant t_2}}{\min} \biggl\{ \int\limits_{t_1}^{t_2} \funcL\bigl(\m{x}(\m{u}, t), \m{u}, t\bigr)\,dt \biggr\} \text{.}
\eeq

Для некоторого момента времени $t'$ из интервала между $t_1$ и $t_2$ это выражение можно написать в таком виде:

\beq{eq:2/1/3}
    \optF(\m{x}_1, t_1) = \underset{\substack{\m{u}(t) \in \m{\Omega}(t) \\ t_1 \leqslant t \leqslant t_2}}{\min} \biggl\{ \int\limits_{t_1}^{t'} \funcL\bigl(\m{x}(\m{u}, t), \m{u}, t\bigr)\,dt + \int\limits_{t'}^{t_2} \funcL\bigl(\m{x}(\m{u}, t), \m{u}, t\bigr)\,dt \biggr\} \text{.}
\eeq

Уравнение~\ref{eq:2/1/3} позволяет применить для его решения принцип оптимальности. Для случая непрерывных систем принцип оптимальности можно сформулировать следующим образом.

\begin{statement}\lbl{statement:1}
    Оптимальное управление $\optU(t)$ на интервале времени $[t_1, t_2]$ имеет следующее свойство: для любого $t'$, заключенного в интервале $t_1 < t' < t_2$ независимо от значений, которые управление $\optU(t)$ принимало на интервале времени $[t_1, t']$, и, следовательно, независимо от значения $\optX(t')$ оно должно оставаться оптимальным управлением относительно состояния $\optX(t')$ на интервале времени $(t', t_2]$.
\end{statement}

Применяя этот принцип, уравнение~\ref{eq:2/1/3} можно преобразовать к следующему виду

\beq{eq:2/1/4}
    \optF(\m{x}_1, t_1) = \underset{\substack{\m{u}(t) \in \m{\Omega}(t) \\ t_1 \leqslant t \leqslant t'}}{\min} \biggl\{ \int\limits_{t_1}^{t'} \funcL\bigl(\m{x}(\m{u}, t), \m{u}, t\bigr)\,dt + \optF\bigl(\m{x}(t'), t'\bigr) \biggr\} \text{,}
\eeq

где $\m{x}(t')$~--- конечное состояние, которое является результатом действия управления $\m{u}(t)$ на интервале времени $[t_1, t']$\footnote{ Если предположить, что функция $\funcF$ имеет непрерывные частные производные по $\m{x}$ и $t$, можно легко прийти к уравнению Беллмана\cite{BELLMAN1}. Однако, как будет показано ниже, это предположение не выполняется для большого класса задач оптимального управления. В приводимом здесь доказательстве, основанном на работе\cite{TCHAMRAN}, это предположение не используется. }.

При оптимальном управлении $\m{u}(t) = \optU(t)$ на интервале $[t_1, t']$ имеем

\beq{eq:2/1/5}
    \optF(\m{x}_1, t_1) = \int\limits_{t_1}^{t'} \funcL\bigl(\m{x}(\optU, t), \optU(t), t\bigr)\,dt + \optF\bigl(\m{x}(t'), t'\bigr) \text{.}
\eeq

Перенося члены и деля на $t' - t_1$ получим

\beq{eq:2/1/6}
    -\frac{\optF\bigl( \m{x}(t'), t' \bigr) - \optF( \m{x}_1, t_1)}{t' - t_1} = \frac{1}{t' - t_1} \int\limits_{t_1}^{t'} \funcL\bigl(\m{x}(\optU, t), \optU(t), t\bigr)\,dt \text{.}
\eeq

При $t' \to t_1$ уравнение~\ref{eq:2/1/6} принимает вид

\beq{eq:2/1/7}
    \lim_{t' \to t_1} \biggr[ -\frac{\optF\bigl( \m{x}(t'), t' \bigr) - \optF( \m{x}_1, t_1)}{t' - t_1} \biggr] = \funcL\bigl(\m{x}_1, \optU(t_1), t_1\bigr) \text{.}
\eeq

Заметим, что для получения правой части выражения~\ref{eq:2/1/7} как предела правой части уравнения~\ref{eq:2/1/6} используется теорема о среднем значении\cite{FICHTENGOLZ}. Если предел левой части уравнения~\ref{eq:2/1/7} существует, то можно определить величину

\beq{eq:2/1/8}
    \biggl[ \genericdiff{\optF}{t} \biggr]_{\optU, t_1} \eqdef \lim_{t' \to t_1} \biggr[ -\frac{\optF\bigl( \m{x}(t'), t' \bigr) - \optF( \m{x}_1, t_1)}{t' - t_1} \biggr] \text{.}
\eeq

Величина $[ \genericlinediff{\optF}{t} ]_{\optU, t_1}$ есть производная функции $\optF$ по времени, вычисленная в момент времени $t_1$. Анализируя правую часть выражения~\ref{eq:2/1/8}, можно видеть, что производную следует вычислять вдоль траектории, обусловленной управлением $\optU$ и начинающейся в $\m{x}_1$. Иными словами, пусть для некоторой задачи функция $\optF(\m{x}, t)$ определена для любого начального состояния $\m{x}$ и начального момента времени $t$. Пусть $\m{x}\bigl( \m{u}(t), t \bigr)$ определяет траекторию, обусловленную управлением $\m{u}(t)$; тогда вдоль любой из этих траекторий величина $\optF(\m{x}, t)$ будет изменяться во времени со скоростью, определяемой величиной $[ \genericlinediff{\optF}{t} ]_{\m{u}, t}$. В частности, вдоль оптимальной траектории она будет изменяться со скоростью $[ \genericlinediff{\optF}{t} ]_{\optU, t}$.

Таким образом

\beq{eq:2/1/9}
    \biggl[ \genericdiff{\optF}{t} \biggr]_{\optU, t_1} + \funcL\bigl(\m{x}_1, \optU(t_1), t_1\bigr) = 0 \text{.}
\eeq

Заметим, что при $\m{u}(t) \neq \optU(t)$ для интеграла~\ref{eq:2/1/5} в соответствии с определением должно выполняться неравенство

\beq{eq:2/1/10}
    \optF(\m{x}_1, t_1) \leqslant \int\limits_{t_1}^{t'} \funcL\bigl(\m{x}(\optU, t), \optU(t), t\bigr)\,dt + \optF\bigl(\m{x}(t'), t'\bigr) \text{.}
\eeq

Откуда следует, что

\beq{eq:2/1/11}
    \biggl[ \genericdiff{\optF}{t} \biggr]_{\m{u}, t_1} + \funcL\bigl(\m{x}_1, \m{u}(t_1), t_1\bigr) \geqslant 0 \text{.}
\eeq

Используя выражения~\vref{eq:2/1/9} и~\ref{eq:2/1/11}, получим

\beq{eq:2/1/12}
    \biggl[ \genericdiff{\optF}{t} \biggr]_{\m{u}, t_1} + \funcL\bigl(\m{x}_1, \m{u}(t_1), t_1\bigr) \geqslant \biggl[ \genericdiff{\optF}{t} \biggr]_{\optU, t_1} + \funcL\bigl(\m{x}_1, \optU(t_1), t_1\bigr) \text{,}
\eeq

или

\beq{eq:2/1/13}
    \underset{\m{u}(t_1) \in \Upsilon}{\min} \biggl\{ \biggl[ \genericdiff{\optF}{t} \biggr]_{\m{u}, t_1} + \funcL\bigl(\m{x}_1, \m{u}(t_1), t_1\bigr) \biggr\} = 0 \text{.}
\eeq

Уравнение~\ref{eq:2/1/13} справедливо в любой момент времени из интервала $[t_1, t_2]$, так что для любого момента времени $t$ и любого состояния $\m{x}$ на траектории $\optX(t)$, принимая его за начальное, можно написать

\beq{eq:2/1/14}
    \underset{\m{u}(t) \in \Upsilon}{\min} \biggl\{ \biggl[ \genericdiff{\optF}{t} \biggr]_{\m{u}, t} + \funcL\bigl(\m{x}(\m{u}, t), \m{u}, t\bigr) \biggr\} = 0 \text{.}
\eeq

Уравнение~\ref{eq:2/1/14} и есть функциональное уравнение Беллмана в общей форме, выражающее необходимое условие оптимальности.

Для любого состояния $\m{x}$ и момента времени $t$, когда функция $\genericlinediff{\optF}{t}$, $\genericlinediff{\optF}{\m{x}}$ и $f(\m{x}, \m{u}, t)$ непрерывны по $\m{x}$ и $t$, полную производную $[\genericlinediff{\optF}{t}]_{\m{u}, t}$ можно записать так:

\beq{eq:2/1/15}
    \biggl[ \genericdiff{\optF}{t} \biggr]_{\m{u}, t} = \biggl(\partdiff{\optF}{\m{x}}\biggr)^T f(\m{x}, \m{u}, t) + \partdiff{\optF}{t} \text{.}
\eeq

Так как частная производная $\partlinediff{\optF}{t}$ не зависит от $\m{u}$, уравнение \ref{eq:2/1/14} можно представить в виде

\beq{eq:2/1/16}
    - \partdiff{\optF}{t} = \underset{\m{u}(t) \in \Upsilon}{\min} \Biggl\{ \funcL\bigl(\m{x}(\m{u}, t), \m{u}, t\bigr) + \biggl(\partdiff{\optF}{\m{x}}\biggr)^T f(\m{x}, \m{u}, t) \Biggr\} \text{.}
\eeq

В тех случаях, когда это уравнение применимо, оно обеспечивает необходимое условие оптимальности. Отметим, что оно является необычной формой дифференциального уравнения в частных производных, которое включает операцию минимизации. Это, в общем случае нелинейное, дифференциальное уравнение в частных производных первого порядка относительно одной переменной $\optF$. Это уравнение определяет одноточечную краевую задачу с граничным условием вида

\beq{eq:2/1/17}
    \lim_{t_1 \to t_2} \optF(\m{x}_1, t_1) = \lim_{t_1 \to t_2} \int\limits_{t_1}^{t_2} \funcL(\optX, \optU, t)\,dt = 0 \text{.}
\eeq

Очевидно, это условие соответствует двум.

\benum
    \item
        Оно указывает, как следует вести поиск оптимальной $\m{u}(t)$: в любой момент времени $t$ поиск должен быть таким, чтобы минимизировать величину, заключенную в квадратные скобки в уравнении~\vref{eq:2/1/16}.

    \item
        Если функция оптимального управления $\optU(t)$ найдена, то~\ref{eq:2/1/16} сводится к уравнению без операции минимизации
        \beq{eq:2/1/18}
            - \partdiff{\optF}{t} = \funcL\bigl(\m{x}(\optU(t), t), \optU, t\bigr) + \biggl(\partdiff{\optF}{\m{x}}\biggr)^T f(\m{x}(\optU(t), t), \optU, t) \text{,}
        \eeq
        которому удовлетворяет функция $\optF(\m{x}, t)$ для всех значений $t$ в интервале $[t_1, t_2]$.
\eenum

При отсутствии ограничений на величину $\m{u}$ и при условии, что функции $\funcL$ и $f$ имеют частные производные по $\m{u}$, оптимальное управление $\optU(t)$ можно найти путем дифференцирования выражения, заключенного в квадратные скобки в уравнении~\ref{eq:2/1/16} и приравнивания полученного результата к нулю. Это дает условие

\beq{eq:2/1/19}
    \biggl[ \partdiff{\funcL}{\m{u}} + \sum\limits_{i=1}^n \partdiff{\optF}{\m{x}_i} \emptyarg \partdiff{f_i}{\m{u}} \biggr] = 0 \text{ для всех } t \in [t_1, t_2] \text{.}
\eeq

Если показатель качества соответствует задаче Майера, а именно $\funcF = P\bigl( \m{x}(t_2), t_2 \bigr)$, то, придерживаясь тех же рассуждений, получим соответствующее уравнение Беллмана

\beq{eq:2/1/20}
    \underset{\m{u}(t) \in \Upsilon}{\min} \Biggl\{ \biggl[ \genericdiff{\optF}{t} \biggr]_{\m{u}, t} \Biggr\} = 0
\eeq

с граничным условием

\beq{eq:2/1/21}
    \lim_{t_1 \to t_2} \optF\bigl(\m{x}(t_1), t_1\bigr) = P\bigl(\m{x}(t_2), t_2\bigr) \text{.}
\eeq

В тех же случаях, когда функции $\partlinediff{\optF}{t}$, $\partlinediff{\optF}{\m{x}}$ и $f(\m{x}, \m{u}, t)$ непрерывны по $\m{x}$ и $t$, имеем

\beq{eq:2/1/22}
    - \partdiff{\optF}{t} = \underset{\m{u}(t) \in \Upsilon}{\min} \Biggl\{ \biggl(\partdiff{\optF}{\m{x}}\biggr)^T f(\m{x}, \m{u}, t) \Biggr\}
\eeq

с тем же граничным условием~\ref{eq:2/1/21}.

\br

Отметим, что тип граничного условия для конечного состояния не играет роли при выводе функционального уравнения. Таким образом, уравнение Беллмана~\ref{eq:2/1/14} или~\vref{eq:2/1/16} справедливо для задачи, даже если конечное состояние $\m{x}_2$ задано, а конечный момент времени $t_2$ нет. Условие~\vref{eq:2/1/17} по-прежнему справедливо, и нет необходимости вносить какие-либо изменения при выводе уравнения Беллмана.



% **********************************************************************************************
\section{Синтез оптимального управления в системах с квадратичным критерием качества}
% **********************************************************************************************



Как было показано в предыдущем разделе, динамическое программирование обладает тем свойством, что оптимальная функция управления $\optU$ обычно записывается в виде функции переменных состояния $\m{x}$, и, следовательно, синтезируется система с обратной связью. Однако использование динамического программирования требует решения уравнения Беллмана. Задачу можно решать двумя путями:

\benum
    \item
        Получить $2n$ дифференциальных уравнений с двухточечными граничными условиями с помощью вариационного исчисления или принципа максимума.

    \item
        Получить одно дифференциальное уравнение в частных производных с граничными условиями в одной точке
\eenum

Преимущество второго метода над первым не очевидно. Однако есть ряд задач о синтезе регулятора, где второй метод оказывается удобнее и практичнее. Сформулируем следующую задачу\footnote{ Более детально задачи о синтезе регуляторов такого рода рассматривали Калман\cite{KALMAN1} и Мэрриэм\cite{MERRIAM}. }.

Пусть дан линейный нестационарный объект управления, который описывается уравнением $\dot{\m{x}} = \m{A}(t)\m{x} + \m{B}(t)\m{u}$ с начальным условием $\m{x}(t_1) = \m{x}_1$ и не заданным конечным состоянием $\m{x}(t_2)$. Необходимо найти\footnote{Необходимость использовать этот критерий возникает в тех случаях, когда требуется существование второй вариации от заданного функционала.} оптимальную функцию управления $\optU(t)$ на интервале $[t_1, t_2]$, минимизирующую функционал

\beq{eq:2/2/1}
    \funcF = \frac{1}{2} \m{x}_2^T \m{M} \m{x}_2 + \frac{1}{2} \int\limits_{t_1}^{t_2} \bigl[ \m{x}^T(\tau)\m{Q}(\tau)\m{x}(\tau) + \m{u}^T(\tau)\m{R}(\tau)\m{u}(\tau) \bigr]\,d\tau \text{,}
\eeq

где $\m{M} \in \Rs{n}{n}$, $\m{Q}(t) \in \Rs{m}{m}$ и $\m{R}(t) \in \Rs{n}{n}$~--- симметричные матрицы, причем $\m{Q}(t)$ и $\m{R}(t)$ являются положительно определенными и обладают непрерывными вторыми производными по $t$; $\m{M}$~--- знакоположительная постоянная матрица.

Сформулированная таким образом задача есть задача Больца\cite{XU}. Уравнение Беллмана в этом случае имеет вид

\beq{eq:2/2/2}
\begin{split}
    - \partdiff{\optF}{t} &= \frac{1}{2} \m{x}^T(t)\m{Q}(t)\m{x}(t) + \frac{1}{2} {\optU}^T(t)\m{R}(t)\optU(t)~+ \\
    &+ \biggl(\partdiff{\optF}{\m{x}}\biggr)^T\bigl( \m{A}(t)\m{x}(t) + \m{B}(t)\optU(t) \bigr) \text{.}
\end{split}
\eeq

Граничное условие, вытекающее из уравнений~\vref{eq:2/1/17} и~\vref{eq:2/1/21}, сводится к

\beq{eq:2/2/3}
    \lim_{t \to t_2} \optF(\m{x}, t) = \frac{1}{2} \m{x}^T(t_2) \m{M} \m{x}(t_2) \text{.}
\eeq

Процесс минимизации приводит к условию\cite{KRASOVSKY}

\beq{eq:2/2/4}
    \partdiff{\calf{I}}{\m{u}} \biggm|_{\m{u} = \optU} + \frac{\partial}{\partial \m{u}} \Biggl[ \biggl(\partdiff{\optF}{\m{x}}\biggr)^T\bigl( \m{A}(t)\m{x} + \m{B}(t)\m{u} \bigr) \Biggr] \Biggm|_{\m{u} = \optU} = 0 \text{,}
\eeq

где $\calf{I}$~--- подынтегральное выражение в уравнении~\ref{eq:2/2/1}. Из последнего условия следует, что

\beq{eq:2/2/5}
    \optU(t) = -\m{R}^{-1}(t)\m{B}^T(t) \partdiff{\optF}{\m{x}} \text{.}
\eeq

Если хотим синтезировать линейное управление как функцию координат, то следует как критерий качества $\optF$ принять квадратичную форму

\beq{eq:2/2/6}
    \optF(\m{x}, t) = \frac{1}{2} \m{x}^T\m{P}(t)\m{x} \text{,}
\eeq

где $\m{P}(t) \in \Rs{n}{n}$~--- симметричная матрица.

Подставив выражения~\ref{eq:2/2/5} и~\ref{eq:2/2/6} в уравнение Беллмана~\ref{eq:2/2/2}, получим матричное уравнение Риккати

\beq{eq:2/2/7}
\begin{split}
    - \genericdiff{\m{P}(t)}{t} &= -\m{P}(t)\m{B}(t)\m{R}^{-1}(t)\m{B}^T(t)\m{P}(t) + \m{P}(t)\m{A}(t)~+ \\
    &+ \m{A}^T(t)\m{P}(t) + \m{Q}(t)
\end{split}
\eeq

с граничным условием

\beq{eq:2/2/8}
    \m{P}(t_2) = \m{M} \text{.}
\eeq

Матрицу $\m{P}(t)$ теоретически можно найти, интегрируя уравнение~\ref{eq:2/2/7} в обратном времени с начальным условием~\ref{eq:2/2/8}. После нахожденя матрицы $\m{P}(t)$, так как она симметрична, с помощью выражений~\vref{eq:2/2/5} и~\ref{eq:2/2/6} получим

\beq{eq:2/2/9}
    \optU(\m{x}, t) = -\m{R}^{-1}(t)\m{B}^T(t)\m{P}(t)\m{x}(t) \text{.}
\eeq

Таким образом, единственный абсолютный минимум функционала~\vref{eq:2/2/1} получается только в том случае, если матричное уравнение Риккати имеет одно решение. В отношении последнего Калман\cite{KALMAN1} доказал следующую теорему.

\bteo{teo:1}
    В соответствии с принятыми предположениями, уравнение~\ref{eq:2/2/7} с граничным условием~\ref{eq:2/2/8} имеет единственное решение для матрицы $\m{P}(t)$, при этом управление~\ref{eq:2/2/9} является оптимальным по отношению к критерию оптимальности~\vref{eq:2/2/6}.
\eteo

Иными словами, уравнение Беллмана~\vref{eq:2/2/2} обеспечивает для этого случая достаточное условие оптимальности.

\br

Калман\cite{KALMAN1} показал, что при $T \to \infty$ для полностью управляемой линейной стационарной системы и показателя качества

\beqn
    \funcF = \frac{1}{2} \int\limits_0^\infty \bigl[ \m{x}^T(\tau)\m{Q} \m{x}(\tau) + \m{u}^T(\tau)\m{R} \m{u}(\tau) \bigr]\,d\tau \text{,}
\eeqn

где $\m{Q}$ и $\m{R}$~--- симметричные, положительно определенные постоянные матрицы, справедливо условие $\lim\limits_{T \to \infty}\dot{\m{P}}(t) = 0$ и, таким образом, матричное уравнение Риккати~\ref{eq:2/2/7} сводится к нелинейному матричному алгебраическому уравнению

\beq{eq:2/2/10}
    -\m{P}\m{B}\m{R}^{-1}\m{B}^T\m{P} + \m{P}\m{A} + \m{A}^T\m{P} + \m{Q} = 0 \text{.}
\eeq

Решение этого уравнения определяет постоянную матрицу $\m{P}$. Оптимальное управление имеет вид $\optU(\m{x}, t) = -\m{R}^{-1}\m{B}^T\m{P} \m{x}$. Это уравнение означает, что все переменные состояния должны быть известны, то есть нужно точно измерять выходной сигнал и $n-1$ его производную. Это очень жесткое требование. Применительно к случаю одного управляющего воздействия, Калман\cite{KALMAN2} показал, что если в приведенной выше задаче уравнение~\ref{eq:2/2/10} определяет постоянную матрицу $\m{P}$, получается строгое решение в частотной области.

\br

Пусть объект, определяемый уравнением $\dot{\m{x}} = \m{A}\m{x} + \m{B} \m{u}$, полностью управляем, а показатель качества имеет вид

\beq{eq:2/2/11}
    \funcF = \frac{1}{2} \int\limits_0^\infty \bigl[ \m{x}^T(\tau)\m{Q} \m{x}(\tau) + r\m{u}^2(\tau) \bigr]\,d\tau \text{.}
\eeq

Полагаем $\m{Q}$ положительно определенной и $r > 0$. Тогда оптимальное управление~--- $\optU = -(1/r) \m{B}^T\m{P} \m{x} = -\m{k}^T\m{x}$, где $\m{k}^T \eqdef \m{B}^T\m{P} / r$. Тогда передаточная функция разомкнутой оптимальной системы управления равна\cite{XU}

\beq{eq:2/2/12}
    \funcT(s) = \m{k}^T(s\m{I} - \m{A})^{-1}\m{B} \text{.}
\eeq

\bteo{teo:2}
    Функция $\funcT(s)$, определяемая уравнением~\ref{eq:2/2/12} обладает тем свойством, что при всех частотах $\omega$ справедливо
    \beq{eq:2/2/13}
        \bigl| 1 + \funcT(j\omega) \bigr| > 1 \text{.}
    \eeq
\eteo

\proof

Заметим, что показатель качества~\ref{eq:2/2/11} можно нормировать так, что $r=1$. Тогда уравнение~\ref{eq:2/2/10} принимает вид\footnote{ В случае одного управляющего воздействия вектор $\m{R}$ в уравнении~\ref{eq:2/2/10} переходит в скаляр $r$. }

\beq{eq:2/2/14}
    - \m{P}\m{A} - \m{A}^T\m{P} = \m{Q} - \m{P}\m{B} \m{B}^T\m{P} \text{.}
\eeq

Прибавляя и вычитая $s\m{P}$, получим

\beq{eq:2/2/15}
    \m{P}(s\m{I} - \m{A}) + (-s\m{I} - \m{A}^T)\m{P} = \m{Q} - \m{P}\m{B}\m{B}^T\m{P} \text{.}
\eeq

Передаточная функция объекта от $\m{u}$ до $\m{x}$ определяется выражением $\m{H}(s) = (s\m{I}-\m{A})^{-1}\m{B}$. Если обе стороны уравнения~\vref{eq:2/2/15} предварительно умножить на $\m{H}^T(-s)$, а затем на $\m{H}(s)$, то найдем

\beqn
    \m{H}^T(-s)\m{P} \m{B} + \m{B}^T\m{P}\m{H}(s) = \m{H}^T(-s)[\m{Q} - \m{P}\m{B}\m{B}^T\m{P}]\m{H}(s)
\eeqn

или

\beq{eq:2/2/16}
    \begin{split}
        \m{H}^T(-s)\m{P}\m{B} &+ \m{H}^T(-s)\m{P}\m{B}\m{B}^T\m{P}\m{H}(s)~+\\
        &+ \m{B}^T\m{P}\m{H}(s) = \m{H}^T(-s)\m{Q}\m{H}(s) \text{,}
    \end{split}
\eeq

так как положительно определенную матрицу $Q$ можно представить в виде\cite{BELLMAN2}

\beqn
    \m{Q} = \m{D}^T\m{\Lambda}\m{D} \text{,}
\eeqn

где матрица $\m{D}$~--- действительная, а матрица $\m{\Lambda}$~--- действительна, положительно определенная и диагональная.

Уравнение~\ref{eq:2/2/16} с учетом того, что $\m{k} = \m{P}\m{B}$, можно записать следующим образом:

\beq{eq:2/2/17}
    \bigl( 1+\m{H}^T(-s)\m{k} \bigr)\bigl( 1+\m{k}^T\m{H}(s) \bigr) = 1 + \m{H}^T(-s)\m{D}\m{\Lambda}\m{D}\m{H}(s) \text{.}
\eeq

Ввиду того, что $\m{k}^T\m{H}(s) = \funcT(s)$, при $s = j\omega$ имеем

\beq{eq:2/2/18}
    \bigl| 1 + \funcT(j\omega) \bigr|^2 = 1 + \m{H}^T(-j\omega)\m{D}^T\m{\Lambda}\m{D}\m{H}(j\omega) \text{.}
\eeq

Так как последний член уравнения~\vref{eq:2/2/15} всегда положителен, то из~\ref{eq:2/2/18} следует, что условие теоремы~\ref{eq:2/2/13} выполнено.\qed

Условие~\ref{eq:2/2/13} можно представить в виде единичной окружности с центром в точке $-1 + j0$, которую годограф $\funcT(j\omega)$ не должен касаться или входить в нее. Это значит, кто какой бы ни была первоначальная передаточная функция объекта $\sff{G}(s)$, оптимальный линейный регулятор путем компенсации будет превращать ее в $\funcT(j\omega)$ с указанными выше свойствами. Другими словами, вследствие строгости условия~\vref{eq:2/2/13} оптимальное уравнение трудно будет осуществить в случае нетривиальных управляемых объектов.

\br

Хотя приведенные выше результаты применимы лишь к системам без элемента сравнения, их можно очень легко распространить на системы с элементами сравнения и входными сигналами, принадлежащими определенному классу. Однако такое обобщение остается за рамками этой работы.



% **********************************************************************************************
\section{Связь с принципом максимума}
% **********************************************************************************************




Введем понятие принципа максимума. Пускай задана система $\dot{\m{x}} = f(\m{x}, \m{u}, t)$, с начальным условием $\m{x}(t_1) = \m{x}_1$. Необходимо выбрать такую функцию управления $\m{u}(t)$ на интервале $t \in [t_1, t_2]$, чтобы

\benum
    \item
        Изображающая точка была переведена из состояния $\m{x}_1$ в момент времени $t_1$ в такое состояние в момент времени $t_2$, чтобы первые $m$ ($m \leqslant n$) составляющий текущего вектора состояния $\m{x}$ ($x_1, x_2, \ldots, x_m$) совпадали с $m$ составляющих заданного конечного состояния $s_1, s_2, \ldots, s_m$ и чтобы функционал
        \beq{eq:2/3/1}
            \funcF = \int\limits_{t_1}^{t_2} \funcL(\m{x},\m{u},t)\,dt
        \eeq
        достигал бы минимума.

    \item
        Были учтены все ограничения, наложенные на $\m{u}(t)$; без потери общности можно считать, что $\m{u}(t)$ принимает значения внутри $r$-мерного единичного куба, определяемого условием $|u_i(t)| \leqslant 1$ ($i = 1,2,\ldots,r$).
\eenum

В приведенной формулировке некоторые переменные состояния остались свободными в конечный момент времени $t_2$. Полагаем, что функция $f(\m{x}, \m{u}, t)$ является непрерывной функцией от $\m{u}$, кусочно-непрерывной по $t$ и непрерывно дифференцируемой по $\m{x}$. Полагаем, что функция $\funcL$ обладает теми же свойствами.

Учтем формулу~\ref{eq:2/3/1} непосредственно в формулировке задачи. Это достигается путем введения дополнительной переменной состояния $x_0$, где

\beq{eq:2/3/2}
    \dot{x}_0 \equiv \funcL(\m{x}, \m{u}, t) \text{.}
\eeq

Определим два $(n+1)$-мерных вектора $\m{x}'$ и $f'$ соответственно с составляющими $x_0, x_1, \ldots, x_n$ и $\funcL, f_1, f_2, \ldots, f_n$. Уравнения для расширенной системы можно записать в таком виде

\beq{eq:2/3/3}
    \dot{\m{x}} = f'(\m{x}', \m{u}, t) \text{,}
\eeq

причем $x_0(t_1) = 0$, $x_0(t_2) = \funcF$.

Задачу оптимизации, рассматриваемую в расширенном пространстве размерности $n+1$, можно теперь сформулировать таким образом: в $(n+1)$-мерном пространстве состояний с координатами $x_0, x_1, \ldots, x_n$ найти допустимое управление $\optU(t)$ ($t_1 \leqslant t \leqslant t_2$), которое переводит систему из начального положения $x_0 = 0$, $\m{x} = \m{x}_1$ в конечное таким образом, что $x_i(t_2) = s_i$ при $i = 1, 2, \ldots, m$, а $x_0(t_2)$ принимает наименьшее значение.

Введем $(n+1)$-мерный вектор $\m{\psi}(t)$ и образуем следующую функцию Гамильтона от четырех переменных $\m{x}'$, $\m{u}$, $t$, $\m{\psi}'$

\beq{eq:2/3/4}
    H(\m{x}', \m{u}, t, \m{\psi}') \eqdef \m{\psi}'^T(t)f'(\m{x}', \m{u}, t) \text{.}
\eeq

Сформулируем теперь \emph{принцип максимума} Понтрягина.

\bteo{teo:3}
    Если функция $\optU(t)$ определяет оптимальное управление, а $\optX^\prime(t)$~--- оптимальная траектория, соответствующая $\optU(t)$, согласно уравнению~\ref{eq:2/3/3}, то имеется ненулевая непрерывная векторная функция $\m{\psi}^\prime(t)$ такая, что
    \benum
        \item
            В любой момент времени $t$ (за исключением, возможно, точек, в которых $f'$ или $\m{u}$ являются разрывными) функция Гамильтона вдоль оптимальной траектории $\optX(t)$ достигает максимума. Иначе говоря,
            \beqn
                H(\optX^\prime, \optU, t, \m{\psi}^\prime) \geqslant H(\optX^\prime, \m{u}, t, \m{\psi}^\prime) \text{.}
            \eeqn

        \item
            В любой момент времени $t$ (за исключением, возможно, точек, в которых $f'$ или $\m{u}$ являются разрывными) вектор $\m{\psi}(t)$ удовлетворяет системе
            \beq{eq:2/3/5}
                \dot{\m{\psi}}^\prime(t) = -\partdiff{H(\m{x}^\prime, \optU, t, \m{\psi}^\prime)}{\m{x}^\prime} \biggm|_{\m{x}^\prime = \optX(t)} \text{.}
            \eeq

        \item
            $\m{\psi}_i(t_2) = 0$ при $i= m+1, m+2, \ldots, n$.

        \item
            $\m{\psi}_0(t_2) \leqslant 0$
    \eenum
\eteo

\br

Выражения~\ref{eq:2/1/14} и~\vref{eq:2/1/16} очень похожи на выражения, связанные с максимизацией функции Гамильтона в формулировке задачи оптимального управления на основе принципа максимума. Так как для любой функции $F$ $\max(-F) = \min F$, то выражение~\ref{eq:2/1/14} можно записать в виде

\beq{eq:2/3/6}
    \partdiff{\optF}{t} = \underset{\m{u}(t) \in \Upsilon}{\max} \Bigl\{ -\funcL\bigl( \m{x}(\m{u}, t), \m{u}, t \bigr) - \biggl(\partdiff{\optF}{\m{x}}\biggr)^Tf \Bigr\} \text{.}
\eeq

Если вдоль оптимальной траектории вектор $-\partlinediff{\optF}{\m{x}}$ отождествить с сопряженным вектором $\m{\psi}$, то величина, заключенная в фигурных скобках в уравнении~\ref{eq:2/3/6}, является гамильтонианом $H$ для принципа максимума. В этом случае величина $\partlinediff{\optF}{t}$ представляет собой величину $H(\optX, \optU, t, \m{\psi})$ и выполняется 2 условие теоремы~\vref{teo:3}. При этих условиях имеем

\beqarr
    \lbl{eq:2/3/7}
        \partdiff{\optF}{\m{x}} = \m{\psi}(t) \text{;} \\
    \lbl{eq:2/3/8}
        \partdiff{\optF}{\m{x}} = \funcH \eqdef H(\optX, \optU, t, \m{\psi})
\eeqarr

Таким образом, сопряженный вектор $\m{\psi}'$, соответствующий оптимальной траектории, представляет собой вектор, направленный в сторону, противоположную направлению градиент критерия оптимальности $\optF$. Так как вектор градиента направлен в сторону быстрейшего изменения функции, то вектор $\m{\psi}$ располагается в каждый момент времени в направлении быстрейшего изменения критерия оптимальности.

Для расширенной системы имеем $H = \m{\psi}'^T\dot{\m{x}}$. При этом принцип оптимальности дает $\partlinediff{\optF}{\dot{\m{x}}} = \m{\psi}'$. Итак, условие $\max\limits_{\m{u} \in \m{\Omega}(t)} H$ в принципе максимума означает, что в расширенном $(n+1)$-мерном пространстве управлений $\optU \in \Upsilon$ следует выбирать таким образом, чтобы в любой момент времени составляющая вектора $\dot{\m{x}}$ в направлении наискорейшего убывания величины $\optF$ была максимально большой.

Из выражения~\ref{eq:2/3/8} видно, что оптимальная функция Гамильтона $\funcH$ равна скорости изменения критерия оптимальности при отсчете времени от выбранной начальной точки. Поэтому ясно, почему в случае оптимального по быстродействию управления стационарным объектом функция $\funcH$ должна равняться нулю. Последнее видно из рассмотрения величины $\partlinediff{\optF(\m{x}, t)}{t}$. Напомним, что $t$ в $\optF(\m{x}, t)$ представляет собой начальное время. При фиксированной начальной точке оптимальное время достижения любой данной точки не зависит от начального времени для стационарного объекта управления, а следовательно $\funcH = 0$.

Иными словами, всякий раз, когда управляемый объект и функция стоимости $\funcL$ не зависит явно от времени, а конечное время $t_2$ не фиксировано, то $\partlinediff{\optF}{t}$ будет всегда равняться нулю, следовательно во всех этих случаях $\funcH = 0$.

Выражая уравнение Беллмана через гамильтониан $H$, можно записать

\beq{eq:2/3/9}
    \partdiff{\optF}{t} - H\biggl( \optX, \optU, t, \partdiff{\optF}{\m{x}} \biggr) = 0 \text{.}
\eeq

Это уравнение совпадает с уравнением Гамильтона--Якоби\cite{XU}.

\br

Предположим, требуется найти оптимальное линейное управление с обратной связью для системы с точно определенным входным сигналом $z(t)$. Цель управления состоит в том, чтобы удерживать выходной сигнал близким к входному, не затрачивая при этом чрезмерно много энергии. Задачу можно сформулировать следующим образом.

Пусть выходной сигнал объекта $\dot{\m{x}} = \m{A}(t)\m{x} + \m{B}(t)\m{u}$ определяется как $y(t) = \m{C}(t)\m{x}(t)$, где векторы $\m{x}$ и $\m{y}$ соответственно $n$- и $m$-мерны. Пусть входной сигнал есть $m$-мерный вектор $\m{z}(t)$, а ошибка системы равна $\m{e}(t) = \m{z}(t) - \m{y}(t)$. Соответствующий показатель качества имеет вид

\beq{eq:2/3/10}
    \funcF = \m{e}^T(t_2) \m{M} \m{e}(t_2) + \frac{1}{2} \int\limits_{t_1}^{t_2} \bigl( \m{e}^T(\tau) \m{Q}(\tau) \m{e}(\tau) + \m{u}^T(\tau)\m{R}(\tau)\m{u}(\tau) \bigr)\,d\tau \text{;}
\eeq

его необходимо минимизировать, найдя оптимальное управление $\optU(\m{x}, t)$.

Определим гамильтониан

\beq{eq:2/3/11}
\begin{split}
    H &= -\frac{1}{2} \bigl( \m{z}(t) - \m{C}(t)\m{x}(t) \bigr)^T\m{Q}(t)\bigl( \m{z}(t) - \m{C}(t)\m{x}(t) \bigr)~-\\
    &- \frac{1}{2} \bigl( \m{u}^T(t)\m{R}(t)\m{u}(t) \bigr) + \biggl( \bigl(\m{A}(t)\m{x}(t) \bigr)^T + \bigl(\m{B}(t)\m{x}(t) \bigr)^T \biggr)\m{\psi}(t)
\end{split}
\eeq

Оптимальную функцию управления $\optU(t)$ найдем из уравнения

\beqn
    \partdiff{H}{\m{u}}\biggm|_{\m{u} = \optU} = 0 \text{,}
\eeqn

откуда

\beq{eq:2/3/12}
    \optU(t) = -\m{R}^{-1}\m{B}^T(t)\m{\psi}(t) = -\m{R}^{-1}(t)\m{B}^T(t)\partdiff{\optF(\m{x}, t)}{\m{x}} \text{.}
\eeq

Это имеет смысл при условии существования обратной матрицы $\m{R}^{-1}(t)$ для всех $t$. Таким образом, удалось получить результат, аналогичный~\vref{eq:2/2/5}, но из других соображений.



% **********************************************************************************************
\section{Достаточное условие оптимальности}
% **********************************************************************************************



Докажем теорему о том, что уравнение Беллмана представляет собой условие оптимальности\cite{TCHAMRAN}.

\bteo{teo:4}
    Рассмотрим систему $\dot{\m{x}} = f(\m{x}, \m{u}, t)$, начинающую движение из начального состояния $\m{x}(t_1) = \m{x}_1$ на интервале времени $t \in [t_1, t_2]$. Требуется найти управление $\m{u}(t) = \optU(t)$, доставляющее минимум функционалу~\vref{eq:2/1/1}.

    Пусть область цели представляет собой открытое множество $\setS$, а конечный момент времени $t_2$ не задан. Обозначим через $\setV$ открытую область, в которой функция $\funcV(\m{x}, t)$ определяется следующим образом

    \benum
        \item
            $\partlinediff{\funcV}{t}$ непрерывная по $\m{x}$ и $t$, а $\partlinediff{\funcV}{\m{x}}$ или непрерывная по $\m{x}$ и $t$, или удовлетворяет условию
            \beq{eq:2/4/1}
                \lim\limits_{t \to \tau-0} \Biggl[ \biggl(\partdiff{\funcV}{\m{x}}\biggr)^Tf \Biggr] = \lim\limits_{t \to \tau+0} \Biggl[ \biggl(\partdiff{\funcV}{\m{x}}\biggr)^Tf \Biggr]
            \eeq
            в любой момент времени $t = \tau$, когда $\partlinediff{\funcV}{\m{x}}$ или $f(\m{x}, \m{u}, t)$ разрывны.

        \item
            Для каждого $\m{x} \in \setV$ в каждый момент времени $t$ функция Гамильтона $H(\m{x}, \m{u}, t, \partlinediff{\funcV}{\m{x}})$ имеет абсолютный минимум при $\m{u} = \optU$ из множества допустимых функций управления. Кроме того, управление $\optU(t)$ определяет единственную траекторию системы $\optX(t)$.

        \item
            На конечном множестве $\setS$ функция $\funcV(\m{x}, t) = 0$.
    \eenum

    Тогда $\funcV(\m{x}, t) = \optF(\m{x}, t)$ при всех допустимых функциях управления, которые переводят изображающую точку из состояния $\m{x}_1$ в $\setS$, не покидая области $\setV$. Далее оптимальное управление с обратной связью $\optU(\m{x}, t)$ можно получить, решая соответствующее уравнение Беллмана.
\eteo


\proof

В соответствии с условиями 1 и 2 теоремы можно написать

\beq{eq:2/4/2}
\begin{split}
    0 &= \partdiff{\funcV}{t} + \Biggl[ \biggl(\partdiff{\funcV}{\m{x}}\biggr)^T f(\m{x}, \optU, t) + \funcL(\m{x}, \optU, t) \Biggr]~<\\
       & < \partdiff{\funcV}{t} + \Biggl[ \biggl(\partdiff{\funcV}{\m{x}}\biggr)^T f(\m{x}, \m{u}, t) + \funcL(\m{x}, \m{u}, t) \Biggr] \text{.}
\end{split}
\eeq

Проинтегрировав левую часть~\ref{eq:2/4/2} вдоль траектории $\optX(t)$ от $t_1$ до оптимального конечного момента $t_2^{*}$, получим

\beq{eq:2/4/3}
\begin{split}
    \int\limits_{t_1}^{t_2} \Biggl[ \partdiff{\funcV(\optX, t)}{t} &+ \biggl(\partdiff{\funcV(\optX, t)}{\m{x}}\biggr)^T f(\optX, \optU, t) \Biggr]\,dt + \int\limits_{t_1}^{t_2} \funcL(\optX, \optU, t)\,dt~= \\
    &= \int\limits_{t_1}^{t_2^{*}} \biggl[ \genericdiff{\funcV}{t} \biggr]_{\optU, t}\,dt + \int\limits_{t_1}^{t_2^{*}} \funcL(\optX, \optU, t)\,dt = 0 \text{.}
\end{split}
\eeq

Рассмотрим теперь интеграл

\beq{eq:2/4/4}
    W \eqdef \int\limits_{t_1}^{t_2^{*}} \Biggl[ \partdiff{\funcV}{t} + \biggl(\partdiff{\funcV}{\m{x}}\biggr)^T f(\m{x}, \m{u}, t) + \funcL(\m{x}, \m{u}, t) \Biggr]\,dt \text{.}
\eeq

Далее допустим, что сочетание $\optU$ и $\optX$ является единственным, которое доставляет абсолютный минимум величине $W$, равный в соответствии с условием~\ref{eq:2/4/3} нулю. Если это неверно, то найдутся другие $\m{u}(t) \neq \optU(t)$ и $\m{x}(t) \neq \optX(t)$, которые сделают выражение~\ref{eq:2/4/4} равным нулю. Однако из условия~\ref{eq:2/4/2} следует, что подынтегральное выражение~\ref{eq:2/4/4} всегда положительно. Таким образом, чтобы обратить $W$ в нуль, указанное подынтегральное выражение должно равняться нулю на всем интервале $[t_1, t_2]$. Из условий~\ref{eq:2/4/2} следует, что сделать это может лишь пара $\optU(t)$ и $\optX(t)$.

Таким образом, теорема~\vref{teo:4} доказана. \qed



% **********************************************************************************************
\section{Область применимости результатов}
% **********************************************************************************************



Сделаем ряд замечаний относительно оптимальных линейных законов управления. Неверным является суждение, что во всех конкретных случаях удается свести системы к стандартной форме и применить формулы, приведенные в этом разделе. С этим классом задач связан ряд серьезных трудностей.

Во-первых, критерий~\vref{eq:2/2/1} зачастую вызывает сомнения в целесообразности применения. Не существует обоснованного способа выбора нужных весовых матриц $\m{M}$, $\m{Q}(t)$ и $\m{R}(t)$. Очень часто соответствующие матрицы находят из эвристических соображений, методом проб и ошибок, причем наиболее удовлетворительную переходную характеристику определяют на глаз.

Во-вторых, закон оптимального управления с обратной связью использует все переменные состояния, а это обычно означает, что выход и $n-1$ его производных нужно измерять без ошибок, что в большинстве реальных систем попросту невозможно.

В-третьих, при отсутствии входного сигнала матрицу обратной связи $\m{P}(t)$ необходимо получить путем решения нелинейной системы уравнений~\vref{eq:2/2/7}. Обычно это выполняется численными методами. С инженерных позиций этот метод малоудовлетворительный не только потому, что для систем высокого порядка трудоемкость и объем вычисления существенно возрастают, но также потому, что полученных результат представляет собой совокупность $n(n+1)/2$ функций времени, которые являются коэффициентами усиления в канале обратной связи. Применительно к нестационарным системам правильность получаемых результатов вызывает сомнение, и любая попытка проверить полученный результат путем использования уравнения Беллмана может оказаться в высшей степени трудоемкой.

В-четвертых, условие~\vref{eq:2/2/13}, являющееся по существу условием оптимальности для стационарных систем, накладывает исключительно жесткие ограничения, практически делая невозможным расчет сколько-нибудь сложных систем.
