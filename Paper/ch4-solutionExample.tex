% coding: utf-8
% --------------------------------------------------------------------------------------------------
% "Синтез оптимального стохастического управления", 2011 год
% --------------------------------------------------------------------------------------------------



\chapter{Пример решения типовой задачи}
% ==============================================================================================
\renewcommand{\optU}{  \optimum{\m{u}} } % оптимальное управление
\renewcommand{\funcF}{ \calf{F}        } % множество F
\renewcommand{\funcS}{ \calf{S}        } % второстепенный критерий качества
% ==============================================================================================



% **********************************************************************************************
\section{Постановка задачи}
% **********************************************************************************************



Рассмотрим полученные в разделах 2 и 3 результаты, применим их к конкретной задаче.

Пускай стоит задача вывода на орбиту искусственного спутника. В подобных задачах ракета-носитель должна следовать по номинальной траектории. Но из-за нестационарности параметров, этого не будет. Для коррекции небольших отклонений относительно заданной траектории можно, например, линеаризовать динамику ракеты-носителя относительно заданной траектории. После выбора критерия, можно приступать к расчетам в соответствии с методиками этого раздела.

Динамику линеаризованного контура наведения ракеты можно выразить в следующей форме:

\beq{eq:4/1/1}
	\eqsystem{
		\dot{x}_1 &= x_2 \mbox{,} \\
		\dot{x}_2 &= \frac{k_1}{k_2 - t} x_3 \mbox{,} \\
		\dot{x}_3 &= u \mbox{.}
	}
\eeq

где $0 \leqslant t \leqslant T$ и

\begin{description}
	\item[$x_1$]~--- боковое отклонение от номинальной траектории;
	\item[$x_2$]~--- скорость этого отклонения;
	\item[$x_3$]~--- угол направления вектора тяги.
\end{description}

Зависимость между боковой тягой и боковым ускорением нестационарна и определяется коэффициентом $k_1 / (k_2 - t)$, который учитывает потерю массы при действии тяги. Интегрируемая связь между $x_3$ и $u$ представляет собой линеаризованное уравнение привода.

%\addfigure{fig:1}{x_adaptive_noise_high}{Функции матрицы $\m{P}$.}

Если исходить из предположения о возможности точного измерения $x_1(t)$, $x_2(t)$ и $x_3(t)$, то можно разработать такую систему управления с обратной связью, чтобы обеспечить оптимальное наведение ракеты, удовлетворив при этом заданному показателю качества. Предположим, что используется функционал вида

\beq{eq:4/1/2}
	\funcF = \frac{1}{2} \int\limits_0^T \bigl( \m{x}^T(\tau)\m{Q}(\tau)\m{x}(\tau) + ru(t)^2 \bigr)\,d\tau \mbox{.}
\eeq

Систему~\ref{eq:4/1/1} можно представить в обозначениях раздела 2.2, а именно в виде системы $\m{x}(t) = \m{A}(t)\m{x}(t) + \m{B}(t)\m{u}(t)$. Это возможно, поскольку матрицы $\m{A}$ и $\m{B}$ выражаются как

\beqarr
	\lbl{eq:4/1/3}
		\m{A}(t) = \matr{
			0 & 1 & 0 \\
			0 & 0 & \frac{k_1}{k_2-t} \\
			0 & 0 & 0		
		} \mbox{;} \\
	\lbl{eq:4/1/4}
		\m{B}(t) = \m{b} = \matr{
			0 \\ 0 \\ 1		
		} \mbox{.}
\eeqarr

Иными словами, задача выражается как задача из раздела 2.2 с критерием качества~\vref{eq:2/2/11}. Как было показано, для ее решения, необходимо получить матрицу $\m{P}(t)$ с граничным условием $\m{P}(T) = \m{0}$. Как было показано ранее, оптимальное уравнение в данном случае равно

\beq{eq:4/1/5}
	\optU(t) = -\frac{1}{r}\m{B}(t)^T\m{P}(t)\m{x}(t) = -\frac{1}{r}\m{b}^T\m{P}(t)\m{x}(t) \mbox{.}
\eeq

С другой стороны, так как

\beq{eq:4/1/6}
	\m{P}(t) = \matr{
		p_{11}(t) & p_{21}(t) & p_{31}(t) \\
		p_{12}(t) & p_{22}(t) & p_{32}(t) \\
		p_{13}(t) & p_{23}(t) & p_{33}(t) \\
	} \mbox{,}
\eeq

то учитывая~\ref{eq:4/1/4} и~\ref{eq:4/1/5}, получаем, что

\beq{eq:4/1/7}
	\optU(t) = -\frac{1}{r} \matr{ p_{13}(t) & p_{23}(t) & p_{33}(t) } \m{x}(t) \mbox{.}
\eeq

\br

Учтем теперь влияние атмосферы на движение ракеты. Скорость ветра $\m{V}$, вообще говоря, является векторной случайной функцией, состоящей из координат точки атмосферы и времени

\beq{eq:4/1/8}
	\m{V} = \m{V}(p, q, z, t) \mbox{,}
\eeq

где $p$, $q$, $z$~--- пространственные координаты\footnote{Традиционное обозначение координат как $x_0$, $y_0$ и $z_0$ в работе не используется, поскольку эти символы уже заняты.}, а $t$~--- время. Иными словами, скорость ветра является векторным случайным полем.

Величина $\m{V}$ может быть представлена в виде суммы среднего вектора $\bar{\m{V}}$ и центрированной составляющей $\m{V}_{\mbox{сл}}$:

\beq{eq:4/1/9}
	\m{V} = \bar{\m{V}} + \m{V}_{\mbox{сл}} (p, q, z, t) \mbox{.}
\eeq

Под $\bar{\m{V}}$ понимается среднее по некоторому интервалу времени значение вектора ветра в рассматриваемой точке. Наличие случайной составляющей $\m{V}_{\mbox{сл}}$ означает турбулентность атмосферы.

Вообще говоря, колебания или вариации скорости ветра в атмосфере имеют очень широкий спектр, начиная от годовых изменений и кончая пульсациями с частотой в десятки и даже сотни герц, вызванных самыми мелкими вихрями вблизи поверхности земли или даже самого летательного аппарата. Однако для задач управления движением весьма низкочастотные вариации не имеют значения\cite{KRASOVSKY}, и усреднение в формуле~\ref{eq:4/1/9} может осуществляться по интервалу, измеряемому минутами.

Если все статистические характеристики случайной функции $\m{V}$, вычисляемые для произвольной точки $(p_0, q_0, z_0)$, не зависят от этой точки, то есть одинаковы для рассматриваемого пространства, то турбулентность называется \emph{однородной}. Некоторые статистические характеристики, такие как корреляционные функции или законы совместного распределения вероятностей, вычисляются для двух или большего числа точек рассматриваемого пространства. Если эти статистические характеристики не меняются при параллельных переносах, вращениях и зеркальных отражениях этой системы, то турбулентность называется \emph{изотропной}. Иными словами, поле турбулентности изотропно, если в нем нельзя выделить никакого преимущественного направления.

Принято полагать, что анизотропность турбулентности атмосферы вызыается преимущественно рельефом местности. Для высот, больших 1000 метров, турбулентность атмосферы считают изотропной. При рассмотрении движения ракеты скорость воздуха можно считать случайной функцией не трех, а только одной пространственной координаты $p$, отсчитываемой вдоль траектории полета:

\beq{eq:4/1/10}
	\m{V}_{\mbox{сл}} = \m{V}_{\mbox{сл}} (p, t) \mbox{.}
\eeq

Объясняется это тем, что на движение ракеты как твердого тела слабо влияют высокочастотные составляющие\cite{KRASOVSKY}, создаваемые вихрями меньших размера самой ракеты. Поэтому скорость ветра в пределах контуров тела приближенно можно считать одинаковой. Для аэроупругого летательного аппарата обычно необходимо учитывать более высокочастотные составляющие воздействий турбулентной атмосферы, следовательно уравнение~\ref{eq:4/1/10} не срабатывает.

Возвращаясь к привычным обозначениям, можно считать, что случайная составляющая зависит лишь от времени $t$ и бокового отклонения от номинальной траектории $x_1$:

\beq{eq:4/1/11}
	\m{V}_{\mbox{сл}} = \m{V}_{\mbox{сл}} \bigl(x_1(t), t \bigr) \mbox{.}
\eeq

Впрочем, при достаточно большой скорости самолета вторым аргументом можно пренебречь, полагая

\beq{eq:4/1/12}
	V_{\mbox{сл}} = \m{V}_{\mbox{сл}} \bigl(x_1(t) \bigr) \mbox{.}
\eeq

Это означает, что распределение ветра в пространстве считается как бы <<замороженным>> и зависимость от времени получается за счет того, что самолет пронизывает это распределение. Данное допущение носит название \emph{гипотезы Тейлора}\cite{MONIN}. Гипотеза Тейлора подвергалась экспериментальной проверке неоднократно, противоречащих результатов получено не было.

Скорость ветра, очевидно, влияет на скорость отклонения ракеты с траектории, следовательно система~\vref{eq:4/1/1} может быть переписана с поправкой на турбулентность атмосферы следующим образом:

\beq{eq:4/1/13}
	\eqsystem{
		\dot{x}_1 &= x_2 \mbox{,} \\
		\dot{x}_2 &= \frac{k_1}{k_2 - t} x_3 + V(x_1) \mbox{,} \\
		\dot{x}_3 &= u \mbox{.}
	}
\eeq

Будем считать, что пространство изотропно, а скорость ракеты достаточна для того, чтобы можно было воспользоваться гипотезой Тейлора. Не нарушая общности, можно полагать, средний по интервалу вектор $\m{V}$ равен нулевому. Иными словами, мы предполагаем такую ситуацию, когда нет перепадов давления, и, следовательно, нет постоянного ветра (либо скорость ветра пренебрежительно мала по сравнению со скоростью ракеты), лишь некоторые атмосферные шумы. Небольшие естественные атмосферные воздействия можно представить в виде белого шума, который моделируется стандартным винеровским процессом, определение которому дано на странице~\pageref{df:6}.

Таким образом, систему~\ref{eq:4/1/13} можно представить в виде следующего процесса Ито:

\beq{eq:4/1/14}
	\eqsystem{
		\dot{x}_1 &= x_2 \mbox{,} \\
		\dot{x}_2 &= \frac{k_1}{k_2 - t} x_3 + \xi(t) \mbox{,} \\
		\dot{x}_3 &= u \mbox{.}
	}
\eeq

Функция $\frac{k_1}{k_2 - t} x_3$ в уравнении для $\dot{x}_2$ будет определять коэффицент сноса, а случайная функция $\xi(t)$~--- коэффицент диффузии.

Задачу~\ref{eq:4/1/14} можно моделировать следующим образом

\beq{eq:4/1/15}
	\eqsystem{
		\dot{x}_1 &= x_2 \mbox{,} \\
		\dot{x}_2 &= \frac{k_1}{k_2 - t} x_3 + \xi_t \mbox{,} \\
		\dot{x}_3 &= u \mbox{.}
	}
\eeq

где $\{\xi_t\}_{t=0}^\infty$~--- последовательность независимых одинаково распределенных случайных величин с распределением Гаусса. Известно\cite{ARKHIPOV}, что в этом случае случайный процесс~\ref{eq:4/1/15} будет слабо сходиться к процессу~\ref{eq:4/1/15}.



% **********************************************************************************************
\section{Исследование и анализ алгоритмов решения поставленной задачи}
% **********************************************************************************************



Рассмотрим систему~\ref{eq:4/1/15} c критерием качества~\ref{eq:4/1/2}.

Для того, чтобы получить матрицу $\m{P}(t)$ требуется решить уравнение~\vref{eq:2/2/7}. Непосредственно решая его, в силу~\ref{eq:4/1/3} и~\ref{eq:4/1/4} получаем следующую систему нелинейных дифференциальных уравнений с граничными условиями в одной точке:

\beq{eq:4/2/1}
	\eqsystem{
		\dot{p}_{11}(t) &= \frac{\mathstrut 1}{10}p^2_{13}(t) - \frac{5 \cdot 10^{-7}}{(300-t)^2}         \mbox{,} \\
		\dot{p}_{12}(t) &= \frac{1}{10}p_{13}(t)p_{23}(t) - p_{11}(t)                                     \mbox{,} \\
		\dot{p}_{13}(t) &= \frac{1}{10}p_{13}(t)p_{33}(t) - \frac{k_1}{k_2-t} p_{12}(t)                   \mbox{,} \\
		\dot{p}_{21}(t) &= 0                                                                              \mbox{,} \\
		\dot{p}_{22}(t) &= \frac{1}{10}p^2_{23}(t) - 2p_{12}(t) - \frac{10^{-3}}{(300-t)^2}               \mbox{,} \\
		\dot{p}_{23}(t) &= \frac{1}{10}p_{23}(t)p_{33}(t) - \frac{k_1}{k_2-t}p_{22}(t) - p_{13}(t)        \mbox{,} \\
		\dot{p}_{31}(t) &= 0                                                                              \mbox{,} \\
		\dot{p}_{32}(t) &= 0                                                                              \mbox{,} \\
		\dot{p}_{33}(t) &= \frac{1}{10}p^2_{33}(t) - 2\frac{k_1}{k_2-t}p_{23}(t) - \frac{10^3}{(300-t)^2} \mbox{,}
	}
\eeq

Эту задачу, вследствие нелинейности системы~\ref{eq:4/2/1} нужно решать численно, двигаясь в обратном времени от $t=T$ с граничным условием $\m{P}(T) = \m{0}$.

Таким образом, можно сформулировать первый алгоритм решения задачи:

\balgo{alg:1}
	\benum
		\item
			Для заданных $T$, $r$, $\m{Q}(t)$ требуется решить матричное дифференциальное уравнение~\ref{eq:2/2/7} в обратном времени с граничным условием $\m{P}(T) = \m{0}$. Таким образом, получим траекторию $\m{P}(t)$, где $0 \leqslant t \leqslant T$;
			
		\item
			Пользуясь формулой~\ref{eq:4/1/7} получаем оптимальное управление $\optU(t)$ на интервале $0 \leqslant t \leqslant T$ в каждый момент времени $t$\footnote{Обратим внимание, что таким образом синтезируется управление с обратной связью, следовательно необходимо знать точные значения каждой переменной состояния из вектора $\m{x}(t)$ в рассматриваемый момент времени.}. 
	\eenum
\ealgo

\br

Рассмотрим теперь случай, когда система стационарна. Как было показано ранее, при $T \to \infty$, уравнение~\vref{eq:2/2/7} сводится к нелинейному алгебраическому уравнению Риккати~\vref{eq:2/2/10}. Остальные действия остаются прежними. Формула~\ref{eq:4/1/7} также преобразуется с учетом этой особенности:

\beq{eq:4/2/2}
	\optU(t) = -\frac{1}{r} \matr{ p_{13} & p_{23} & p_{33} } \m{x}(t) \mbox{.}
\eeq

Следовательно, можно построить новый алгоритм, берущий за основу алгоритм~\ref{alg:1}.

\balgo{alg:2}
	\benum
		\item
			Для заданных $T$, $r$, $\m{Q}$ требуется решить матричное алгебраическое уравнение~\ref{eq:2/2/10}. Таким образом, получим матрицу с постоянными коэффициентами $\m{P}$ для всех $0 \leqslant t \leqslant T$;
			
		\item
			Пользуясь формулой~\ref{eq:4/2/2} получаем оптимальное управление $\optU(t)$ на интервале $0 \leqslant t \leqslant T$ в каждый момент времени $t$.
	\eenum
\ealgo

Опять же, стоит обратить внимание на то, что таким образом синтезируется управление с обратной связью, следовательно необходимо знать точные значения каждой переменной состояния из вектора $\m{x}(t)$ в рассматриваемый момент времени.

\br

Метод Беллмана, неявно лежащий в основе вышеприведенных алгоритмов, в некотором смысле аддитивен. Уравнения Беллмана позволяют найти оптимальное управление не только в целом, но и на конкретном шаге. В основной теореме динамического программирования, доказанной Беллманом утверждается, что управление, построенное таким образом, будет оптимальным. Действительно, одним из следствий уравнения~\vref{eq:2/1/17} является тот факт, что в любой момент времени величина критерия должна быть минимальной. Следовательно, если разбить задачу динамического программирования на несколько частей, прямо следующих друг за другом, причем состояние, в котором система оказалась в конце предыдущей части, будет начальным состоянием последующей, то в результате траектория динамики системы окажется такой, при которой критерий качества будет минимальным, а полученное управление~--- оптимальным.

Из уравнений~\ref{eq:2/1/3} и~\ref{eq:2/1/4}, а также из утверждения~\vref{statement:1} следует, что такое кусочное управление будет эквивалентно оптимальному. Возможна ситуация, когда управление, полученное таким образом, будет отличаться от управления, полученного из уравнений~\ref{eq:2/2/8} и~\vref{eq:2/2/9}, однако ввиду того, что значения критериев равны (оба уравнения доставляют минимум критерию качества~\vref{eq:2/2/1}), оба управления будут являться оптимальными. Иными словами, уравнения Беллмана позволяют получить оптимальное управление, но из них, конечно же, никоим образом не следует единственность минимума критерия качества.

Из этих рассуждений следует, что не имеет большого значения то, каким способом получается оптимальное управление в случае детерминированной системы~\vref{eq:4/1/1}, однако различия в подходах имеют смысл в случае стохастической системы~\vref{eq:4/1/14}. В сильно зашумленных системах, где диффузия оказывает большое влияние на динамику траекторий, дробя процесс вычисления траектории на несколько, можно построить адаптивный алгоритм, который будет учитывать не только параметры системы, но и степень отклонения от намеченной траектории. Иными словами, адаптивный характер алгоритма должен минимизировать влияние тех факторов, которые прямо контролировать невозможно, либо слишком сложно и затратно.

Отметим тот факт, что оба предложеных ранее алгоритма рассчитывают управление сразу на весь временной интервал наблюдений, после чего ракета наводится программно, без учета внешних воздействий. Предлагается рассчитывать управление поэтапно.

\br

Основная идея предлагаемого адаптивного управления заключается в следующем. Разобъем временной промежуток наблюдений $0 \leqslant t \leqslant T$ на $n+1$ равную часть: $0 = t_0 \leqslant t_1 \leqslant t_2 \leqslant \ldots \leqslant t_{n} = T$ ($t_{i+1}-t_i = t_{j+1}-t_j$ для всех $i, j < n$). Дальше, следуя алгоритмам~\ref{alg:1} и~\ref{alg:2}, синтезируем управление на всем интервале наблюдений, однако управление используем лишь на первом временном промежутке $[t_0, t_1)$. В момент времени $t_1$ происходит проверка эффективности проведенного управления с помощью некоторых заранее определенных вторичных критериев качества $\funcS(\m{x}_{t_0})$ и $\funcS(\m{x}_{t_1})$ по заданному правилу.

Если сравнение показало, что управление не столь эффективно, как бы этого хотелось, то синтезированное ранее управление отбрасывается, и задача решается заново, но уже для промежутка $t_1 \leqslant t \leqslant T$, однако изначальное деление на интервалы сохраняется.

Если же сравнение управления показало его эффективность на первом интервале, то используется синтезированное ранее управление. В обоих случаях, в конце промежутка $[t_1, t_2)$, в момент времени $t_2$ происходит аналогичная проверка вторичных критериев качества $\funcS(\m{x}_{t_1})$ и $\funcS(\m{x}_{t_2})$.

Такие проверки проводятся вплоть до самого конца временного интервала наблюдений, за исключением лишь момента времени $t_n = T$.



% **********************************************************************************************
\section{Программная реализация решения}
% **********************************************************************************************



% **********************************************************************************************
\section{Результаты решения}
% **********************************************************************************************
