% coding: utf-8
% --------------------------------------------------------------------------------------------------
% "Синтез оптимального стохастического управления", 2011 год
% --------------------------------------------------------------------------------------------------



\documentclass[ignorenonframetext,hyperref={pdftex,unicode},compress]{beamer}
\mode<presentation>{}

\usepackage{cmap}
\usepackage[utf8x]{inputenc}
\usepackage[russian]{babel}
\usepackage[T2A]{fontenc}
\selectlanguage{russian}

\PrerenderUnicode{О проблемах синтеза оптимального регулятора с обратной связью в многомерных стохастических системах}

\hypersetup{
    pdftitle={О проблемах синтеза оптимального регулятора с обратной связью в многомерных стохастических системах},
    pdfauthor={Сергей Архипов},
    pdfsubject={Магистерская диссертация},
    pdfkeywords={Оптимальное управление} {Стохастические системы} {Полет ракеты}
}

\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{mathtext}
\usepackage[mathscr]{eucal}
\usepackage[russian]{varioref}
\usepackage{listings}
\usepackage[font=it,labelsep=period,format=hang]{caption}



% for screen only
\usetheme{Singapore}

% for handout only
%\usetheme{Pittsburgh}
%\usecolortheme{dove}


\newcommand{\br}{\vspace{12pt}}
\newtheorem{teo}{Теорема}
\newtheorem{alg}{Алгоритм}



%-------------------------------------------------------------------------------



\title{О проблемах синтеза оптимального регулятора с обратной связью в многомерных стохастических системах}
\author{Архипов С.\,В.}
\institute{Научный руководитель: Пакшин П.\,В.}
\date{15 июня 2011 г.}



\begin{document}



%-------------------------------------------------------------------------------
%---   слайд 0: титульная страница
%-------------------------------------------------------------------------------
\begin{frame}
    \titlepage
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 1: постановка основной задачи
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Постановка задачи}

    Пусть физический объект описывается системой

	\begin{equation}\label{eq:1}
	    \dot{\mathbf{x}}(t) = \mathbf{A}(t)\mathbf{x}(t) + \mathbf{B}(t)\mathbf{u}(t) \text{.}
	\end{equation}

	Требуется найти такое оптимальное управление $\mathbf{u}^*(t)$, при котором значение критерия качества было бы минимальным:
	
	\begin{equation}\label{eq:2}
	    \mathcal{F} \bigl(  \mathbf{x}(t), \mathbf{u}^*(t)  \bigr) = \min_{\mathbf{u}(t) \in \Upsilon} \mathcal{F} \bigl(  \mathbf{x}(t), \mathbf{u}(t)  \bigr)  \text{.}
	\end{equation}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 2: Синтез оптимального управления -- уравнение Беллмана
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Синтез оптимального управления}
	\framesubtitle{Уравнение Беллмана}

    Пусть критерий качества задан в виде
    
    \begin{equation}\label{eq:3}
    	\mathcal{F} = \int\limits_{t_1}^{t_2} \mathsf{L}(\mathbf{x}, \mathbf{u}, t)\,dt \text{.}
    \end{equation}
    
    Тогда необходимое условие оптимальности запишется как
    
    \begin{equation}\label{eq:4}
    	\underset{\mathbf{u}(t) \in \Upsilon}{\min} \biggl\{ \biggl[ \frac{d \mathcal{F}^*}{d t} \biggr]_{\mathbf{u}, t} + \mathsf{L}\bigl(  \mathbf{x}(\mathbf{u}, t), \mathbf{u}, t  \bigr) \biggr\} = 0 \text{.}
    \end{equation}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 3: Синтез оптимального управления -- уравнение Беллмана, квадратич-
%---            ный критерий качества
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Синтез оптимального управления}
	\framesubtitle{Уравнение Беллмана с квадратичным критерием качества}\small

    Пусть критерий качества задан в виде
    
    \begin{equation}\label{eq:5}
    	\mathcal{F} = \frac{1}{2} \mathbf{x}_2^T \mathbf{M} \mathbf{x}_2 + \frac{1}{2} \int\limits_{t_1}^{t_2} \bigl[ \mathbf{x}^T(\tau)\mathbf{Q}(\tau)\mathbf{x}(\tau) + \mathbf{u}^T(\tau)\mathbf{R}(\tau)\mathbf{u}(\tau) \bigr]\,d\tau \text{.}
    \end{equation}
    
    Тогда оптимальное управление $\mathbf{u}^*(t)$ может быть синтезировано следующим образом:
    
    \begin{equation}\label{eq:6}
    	\mathbf{u}^*(\mathbf{x}, t) = -\mathbf{R}^{-1}(t)\mathbf{B}^T(t)\mathbf{P}(t)\mathbf{x}(t) \text{,}
    \end{equation}
    
    где матрица $\mathbf{P}(t)$ может быть найдена из уравнения Риккати
    
    \begin{equation}\label{eq:7}
    	\begin{cases}
    		\begin{split}
    			- \frac{d \mathbf{P}(t)}{dt} =& -\mathbf{P}(t)\mathbf{B}(t)\mathbf{R}^{-1}(t)\mathbf{B}^T(t)\mathbf{P}(t) + \mathbf{P}(t)\mathbf{A}(t) + \\
    			&+ \mathbf{A}^T(t)\mathbf{P}(t) + \mathbf{Q}(t) \text{;}
			\end{split} \\
			\mathbf{P}(t_2) = \mathbf{M} \text{.}
		\end{cases}    
    \end{equation}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 4: Синтез оптимального управления -- уравнение Беллмана, стационар-
%---            ный случай
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Синтез оптимального управления}
	\framesubtitle{Уравнение Беллмана при $T \to \infty$}

    Пусть критерий качества задан в виде
    
    \begin{equation}\label{eq:8}
    	\mathcal{F} = \frac{1}{2} \int\limits_0^\infty \bigl[ \mathbf{x}^T(\tau)\mathbf{Q} \mathbf{x}(\tau) + \mathbf{u}^T(t)\mathbf{R} \mathbf{u}(\tau) \bigr]\,d\tau \text{.}
    \end{equation}
    
    Тогда оптимальное управление $\mathbf{u}^*(t)$ может быть синтезировано следующим образом:
    
    \begin{equation}\label{eq:9}
    	\mathbf{u}^*(\mathbf{x}, t) = -\mathbf{R}^{-1}\mathbf{B}^T\mathbf{P}\mathbf{x}(t) \text{,}
    \end{equation}
    
    где матрица $\mathbf{P}$ может быть найдена из нелинейного алгебраического матричного уравнения Риккати
    
    \begin{equation}\label{eq:10}
    	-\mathbf{P}\mathbf{B}\mathbf{R}^{-1}\mathbf{B}^T\mathbf{P} + \mathbf{P}\mathbf{A} + \mathbf{A}^T\mathbf{P} + \mathbf{Q} = \mathbf{0} \text{.}    
    \end{equation}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 5: Оптимальное стохастическое управление - постановка задачи
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Оптимальное стохастическое управление}
	\framesubtitle{Постановка задачи}
    
    Пусть система задана в виде процесса Ито:

    \begin{equation}\label{eq:11}
    	d\mathbf{x}_t = \bigl( \mathbf{A}(t)\mathbf{x}_t + \mathbf{B}(t)\mathbf{u}(\mathbf{x}_t, t) \bigr)dt + \mathbf{C}(t)d\mathbf{w}_t \text{.}
    \end{equation}
    
    Тогда оптимальное управление $\mathbf{u}^*(t)$ синтезируется из условия минимума функционала качества:
    
    \begin{equation}\label{eq:12}
    	\mathcal{F}(\mathbf{x}, \mathbf{u}, s) = \mathbb{E} \biggl\{ Q(\mathbf{x}_\tau, \tau) + \int\limits_s^\tau F(\mathbf{x}_t, \mathbf{u}, t)\,dt~\biggm|~ \mathbf{x}_s = \mathbf{x} \biggr\} \text{.}
    \end{equation}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 6: Оптимальное стохастическое управление - квадратичный критерий
%---            качества
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Оптимальное стохастическое управление}
	\framesubtitle{Синтез оптимального управления}\small
    
    Пусть критерий качества является квадратичным

    \begin{equation}\label{eq:13}
    	\mathcal{F}(\mathbf{x}, \mathbf{u}, s) = \mathbb{E} \biggl\{ \mathbf{x}_T\mathbf{R}\mathbf{x}_T^T + \int\limits_s^T \bigr( \mathbf{x}_t^T\mathbf{C}(t)\mathbf{x}_t + \mathbf{u}^T\mathbf{P}(t)\mathbf{u} \bigl)\,dt~\biggm|~ \mathbf{x}_s = \mathbf{x} \biggr\} \text{.}
    \end{equation}
    
    Тогда оптимальное управление можно получить $\mathbf{u}^*(t)$ следующим образом:
    
    \begin{equation}\label{eq:14}
    	\mathbf{u}^*(\mathbf{x}, t) = -\mathbf{R}^{-1}\mathbf{B}^T(t)\mathbf{S}(t)\mathbf{x}(t) \text{,}
    \end{equation}

    где матрица $\mathbf{S}(t)$ находится из системы~\ref{eq:15}

    \begin{equation}\label{eq:15}
    	\begin{cases}
    		\begin{split}
    			-\frac{d\mathbf{S}(t)}{dt} =&~\mathbf{A}^T(t)\mathbf{S}(t) - \mathbf{S}(t)\mathbf{A}(t) +\\
                &+ \mathbf{S}(t)\mathbf{B}(t)\mathbf{P}^{-1}(t)\mathbf{B}(t)\mathbf{S}(t) - \mathbf{C}(t) \text{;}
			\end{split} \\
			\mathbf{S}(T) = \mathbf{R} \text{.}
		\end{cases}    
    \end{equation}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 7: Решение типовой задачи - постановка задачи
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Постановка задачи}
    
    \begin{equation}\label{eq:16}
        \begin{cases}
            \dot{x}_1 = x_2 \text{,} \\
            \dot{x}_2 = \frac{k_1}{k_2 - t} x_3 + \xi(t) \text{,} \\
            \dot{x}_3 = u \text{.}
        \end{cases}
    \end{equation}

    \begin{description}
        \item[$x_1$] ---~~боковое отклонение от номинальной траектории;
        \item[$x_2$] ---~~скорость этого отклонения;
        \item[$x_3$] ---~~угол направления вектора тяги.
    \end{description}

    \begin{equation}\label{eq:17}
        \mathcal{F}(\mathbf{x}, \mathbf{u}, T) = \frac{1}{2} \int\limits_0^T \bigl( \mathbf{x}^T(\tau)\mathbf{Q}(\tau)\mathbf{x}(\tau) + ru^2(\tau) \bigr)\,d\tau \text{.}
    \end{equation}
\end{frame}


%-------------------------------------------------------------------------------
%---   слайд 8: Решение типовой задачи - постановка задачи, точные значения
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Постановка задачи}
    
    \begin{equation*}
        \mathbf{Q}(T) = \frac{1}{(300-t)^2}\begin{bmatrix}
            5 \,\cdotp 10^{-7}  & 0       & 0    \\
            0                   & 10^{-3} & 0    \\
            0                   & 0       & 10^3 \\
        \end{bmatrix}
    \end{equation*}

    \begin{itemize}
        \item $k_1 = 9380$,
        \item $k_2 = 315$,
        \item $r = 10$,
        \item $x_1(0) = 915$ м.,
        \item $x_2(0) = 244$ м/сек.,
        \item $x_3(0) = 0.012$ рад.,
        \item $T = 250$ сек.
    \end{itemize}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 9: Решение типовой задачи - постановка задачи
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Программное обеспечение для проведения экспериментов}
    
    \begin{enumerate}
        \item
            Программа написана на языке программирования \texttt{Java};

        \item
            Использовались \texttt{gnuplot}, \texttt{sed}, \texttt{awk}, \texttt{bash}, \texttt{git};

        \item
            Программное обеспечение разрабатывалось для ОС GNU\textbackslash Linux;

        \item
            Реализация 4 алгоритмов решения задачи управления ракетой с возможностью тонкой настройки;

        \item
            Программный код свободно распространяется через GitHub: \texttt{https://github.com/9seconds/rocketsim}.
    \end{enumerate}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 10: Решение типовой задачи - решение без шума, график P
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Решение задачи без зашумленности. Функции матрицы $\mathbf{P}$.}
    
    \begin{figure}\center
        \input{fig_p}
        \label{fig:p}
    \end{figure}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 11: Решение типовой задачи - решение без шума, динамика состояний
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Решение задачи без зашумленности. Динамика состояний $\mathbf{x}(t)$.}
    
    \begin{figure}\center
        \input{fig_x}
        \label{fig:x}
    \end{figure}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 12: Решение типовой задачи - алгоритм 1, описание
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Описание алгоритма~\ref{alg:1}}
    
    \begin{alg}\label{alg:1}~
        \begin{enumerate}
            \item
                Для заданных $T$, $r$, $\mathbf{Q}(t)$ требуется решить матричное дифференциальное уравнение~\ref{eq:15} в обратном времени с граничным условием $\mathbf{P}(T) = \mathbf{0}$. Таким образом, получим траекторию $\mathbf{P}(t)$, где $0 \leqslant t \leqslant T$;

            \item
                Пользуясь формулой~\ref{eq:14} получаем оптимальное управление $\mathbf{u}^*(t)$ на интервале $0 \leqslant t \leqslant T$ в каждый момент времени $t$.
        \end{enumerate}
    \end{alg}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 13: Решение типовой задачи - алгоритм 1, результаты
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Решение задачи с помощью алгоритма~\ref{alg:1}}
    
    \begin{figure}\center
        \input{fig_alg1}
        \label{fig:alg1}
    \end{figure}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 15: Решение типовой задачи - алгоритм 2, описание
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Описание алгоритма~\ref{alg:2}}
    
    \begin{alg}\label{alg:2}~
        \begin{enumerate}
            \item
                Для заданных $T$, $r$, $\mathbf{Q}(t)$ требуется решить матричное алгербаическое уравнение~\ref{eq:10}. Таким образом, получим матрицу усилений $\mathbf{P}$ для всех $t$ из $0 \leqslant t \leqslant T$;

            \item
                Пользуясь формулой~\ref{eq:9} получаем оптимальное управление $\mathbf{u}^*(t)$ на интервале $0 \leqslant t \leqslant T$ в каждый момент времени $t$.
        \end{enumerate}
    \end{alg}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 15: Решение типовой задачи - алгоритм 2, результаты
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Решение задачи с помощью алгоритма~\ref{alg:2}}
    
    \begin{figure}\center
        \input{fig_alg2}
        \label{fig:alg2}
    \end{figure}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 16: Решение типовой задачи - вторичный критерий качества
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Вторичный критерий качества}
    
    \begin{equation}\label{eq:18}
        \begin{split}
            \mathscr{S}(\mathbf{x}, t_i, t_{i+1}) =&~ \Biggl| \int\limits_{t_i}^{t_{i+1}} \bigl( \mathbf{x}^T(\tau)\mathbf{Q}(\tau)\mathbf{x}(\tau) + ru(\tau)^2 \bigr)\,d\tau -\\
            &- 2\mathcal{F}^*(\mathbf{x}, t_i, t_{i+1}) \Biggr| \text{.}
        \end{split}
    \end{equation}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 17: Решение типовой задачи - алгоритм 3, описание
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Описание алгоритма~\ref{alg:3}}\small
    
    \begin{alg}\label{alg:3}~
        \begin{enumerate}
            \item
                Делим временной интервал наблюдений $[0, T]$ на $n+1$ равную часть: $0 = t_0 \leqslant t_1 \leqslant t_2 \leqslant \ldots \leqslant t_{n} = T$, где $t_{i+1}-t_i = t_{j+1}-t_j$ для всех $i, j < n$. Интервалы типа $[t_i, t_{i+1})$ ($i<n$) назовем \emph{подынтервалами};

            \item
                Строим оптимальное управление $\mathbf{u}^*$ на всем оставшемся интервале наблюдений с помощью алгоритмов~\ref{alg:1} или~\ref{alg:2};

            \item
                Наводим ракету с помощью управления $\mathbf{u}^*$ на протяжении одного подынтервала времени;

            \item
                На открытой границе подынтервала производим расчет вторичного критерия $\mathscr{S}(\mathbf{x}, t_i, t_{i+1})$ (например, заданного уравнением~\ref{eq:18});

            \item
                Если $\mathscr{S}(\mathbf{x}, t_i, t_{i+1}) \leqslant \varepsilon$ ($\varepsilon > 0$), то переходим на шаг 3, в противном случае переходим на шаг 2.
        \end{enumerate}
    \end{alg}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 18: Решение типовой задачи - алгоритм 3, результаты
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Решение задачи с помощью алгоритма~\ref{alg:3}}
    
    \begin{figure}\center
        \input{fig_alg3}
        \label{fig:alg3}
    \end{figure}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 19: Решение типовой задачи - алгоритм 4, описание
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Описание алгоритма~\ref{alg:4}}\footnotesize
    
    \begin{alg}\label{alg:4}~
        \begin{enumerate}
            \item
                Делим временной интервал наблюдений $[0, T]$ на $n+1$ равную часть: $0 = t_0 \leqslant t_1 \leqslant t_2 \leqslant \ldots \leqslant t_{n} = T$, где $t_{i+1}-t_i = t_{j+1}-t_j$ для всех $i, j < n$. Интервалы типа $[t_i, t_{i+1})$ ($i<n$) назовем подынтервалами. Оптимальное управление строится поподынтервально;

            \item
                Строим оптимальное управление $\mathbf{u}^*$ только лишь на следующем подынтервале с помощью алгоритмов~\ref{alg:1} или~\ref{alg:2};

            \item
                Наводим ракету с помощью управления $\mathbf{u}^*$ на протяжении одного подынтервала времени;

            \item
                На открытой границе подынтервала производим расчет вторичного критерия $\mathscr{S}(\mathbf{x}, t_i, t_{i+1})$ (например, заданного уравнением~\ref{eq:18});

            \item
                Если $\mathscr{S}(\mathbf{x}, t_i, t_{i+1}) > \varepsilon$ ($\varepsilon > 0$), то сразу переходим на шаг 2. В противном случае, также переходим на шаг 2, но в качестве следующего подынтервала рассматриваем интервал удвоенной длины, если оставшихся подынтервалов достаточно (если нет~--- берется оставшийся временной промежуток).
        \end{enumerate}
    \end{alg}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 20: Решение типовой задачи - алгоритм 4, результаты
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Решение типовой задачи}
	\framesubtitle{Решение задачи с помощью алгоритма~\ref{alg:4}}
    
    \begin{figure}\center
        \input{fig_alg4}
        \label{fig:alg4}
    \end{figure}
\end{frame}



%-------------------------------------------------------------------------------
%---   слайд 21: Заключение
%-------------------------------------------------------------------------------
\begin{frame}
	\frametitle{Заключение}
    
    \begin{enumerate}
        \item
            Исследована исходная задача управления;

        \item
            Дан общий метод синтеза оптимального управления, основывающийся на уравнениях Беллмана; даны решения задачи в некоторых частных случаях;

        \item
            Полученные результаты распространены на случай стохастических систем;

        \item
            Были разработаны алгоритмы решения задачи синтеза оптимального управления на примере конкретной задачи;

        \item
            Разработан программный комплекс для исследования и анализа алгоритмов;

        \item
            Полученные результаты были проанализированы, даны рекомендации по использованию алгоритмов.
    \end{enumerate}
\end{frame}



\end{document}

